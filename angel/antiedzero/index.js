(function(u,f,c,h,a,E,m,S,P,y,b,k){"use strict";const D=c.findByProps("getChannel","getDMFromUserId"),I=c.findByProps("_channelMessages"),x=c.findByProps("getMessage","getMessages");function Z(r){return f.before("dispatch",a.FluxDispatcher,function(i){if(u.isEnabled)try{const t=i[0];if(!t||!t.type)return;if(t.type==="MESSAGE_DELETE"){if(t.otherPluginBypass)return;const e=I.get(t.channelId)?.get(t.id);if(!e?.author?.id||!e.author.username||e?.author?.bot&&e?.flags==64||e.author.bot||!e.content&&!e.attachments?.length&&!e.embeds?.length)return;const n=r.get(t.id);if(n?.stage===2){r.size>=100&&(r=new Map);return}if(n?.stage===1)return n.stage=2,n.message||i;const l=D.getChannel(e.channel_id||t.channelId)?.guild_id;return t.message={...e,content:e.content,channel_id:e.channel_id||t.channelId,guild_id:l,message_reference:e?.message_reference||e?.messageReference||null,flags:64},t.type="MESSAGE_UPDATE",t.channelId=e.channel_id||t.channelId,t.optimistic=!1,t.sendMessageOptions={},t.isPushNotification=!1,r.set(t.id,{message:i,stage:1}),i}if(t.type==="MESSAGE_UPDATE"){if(t.otherPluginBypass)return;const e=t.message;if(!e||e.author?.bot)return;const n=e.channel_id||t.channelId,l=e.id||t.id,s=x.getMessage(n,l)||I.get(n)?.get(l);if(!s?.author?.id||!s.author.username||!s.content&&!s.attachments?.length&&!s.embeds?.length||!e.content||e.content===s.content)return;let g="`[ EDITED ]`\n\n";return t.message={...e,content:`${s.content} ${g}${e.content}`,guild_id:D.getChannel(n)?.guild_id??e.guild_id,edited_timestamp:"invalid_timestamp",message_reference:e?.message_reference||s?.messageReference||null},i}}catch(t){h.showToast("[ANTIED Zero] FluxDispatcher crash \u2013 check logs"),console.error(`[ANTIED Zero] Flux patch
`,t)}})}const G=c.findByProps("sendMessage","startEditMessage");function j(){return f.before("startEditMessage",G,function(r){if(!u.isEnabled)return;const i=_("`[ EDITED ]`\n\n"),t=new RegExp(i,"gmi"),[,,e]=r,n=e.split(t),l=n[n.length-1];r[2]=l})}const M=c.findByProps("openLazy","hideActionSheet"),z=c.findByProps("getMessage","getMessages"),O=c.findByProps("getChannel","getDMFromUserId"),Q=c.findByProps("_channelMessages"),{ActionSheetRow:w}=c.findByProps("ActionSheetRow");function v(r){return r?.props?.label?.toLowerCase?.()=="reply"}function V(){return f.before("openLazy",M,function([r,i,t]){if(u.isEnabled)try{const e=t?.message;if(i!=="MessageLongPressActionSheet"||!e)return;r.then(function(n){const l=f.after("default",n,function(s,g){try{a.React.useEffect(function(){return function(){l()}},[]);const o=m.findInReactTree(g,function(A){return A?.find?.(v)});if(!o)return g;const ue=Math.max(o.findIndex(v),o.length-1);let d=null;if(e?.channel_id&&e?.id&&(d=z.getMessage(e?.channel_id,e?.id),d||(d=Q.get(e?.channel_id)?.get(e?.id))),!d)return g;const oe=_("`[ EDITED ]`\n\n"),U=new RegExp(oe,"gmi");if(U.test(e.content)){const A=ue||1;o.splice(A,0,a.React.createElement(w,{label:"Remove Edit History",subLabel:"Added by Antied Zero",icon:a.React.createElement(w.Icon,{source:E.getAssetIDByName("ic_edit_24px")}),onPress:function(){const L=e?.content?.split(U),ge=L[L.length-1];a.FluxDispatcher.dispatch({type:"MESSAGE_UPDATE",message:{...e,message_reference:e?.message_reference||e?.messageReference||null,content:`${ge}`,guild_id:O.getChannel(d.channel_id).guild_id},otherPluginBypass:!0}),M.hideActionSheet(),h.showToast("History Removed",E.getAssetIDByName("ic_edit_24px"))}}))}}catch(o){h.showToast("[ANTIED Zero] Crash on ActionSheet, check debug log for more info"),console.error(`[ANTIED Zero] Error > ActionSheet:Component Patch
`,o)}})})}catch(e){h.showToast("[ANTIED Zero] Crash on ActionSheet, check debug log for more info"),console.error(`[ANTIED Zero] Error > ActionSheet Patch
`,e)}})}const T=c.findByStoreName("UserStore"),{ScrollView:H,View:B,Image:N}=y.General,{FormArrow:W,FormRow:p,FormSection:R,FormDivider:F}=y.Forms,K=[{name:"Angel",role:"Author & Maintainer",uuid:"692632336961110087"}],Y=[{name:"Moodle",role:"Quality Assurance",uuid:"807170846497570848"},{name:"Rairof",role:"Quality Assurance",uuid:"923212189123346483"},{name:"Catinette",role:"Quality Assurance",uuid:"1302022854740807730"},{name:"Win8.1VMUser",role:"Quality Assurance",uuid:"793935599702507542"}],q=[{label:"Source Code",url:"https://github.com/angelix1/MP"},{label:"Tip via PayPal",url:"https://paypal.me/alixymizuki"},{label:"Buy me a Ko-fi",url:"https://ko-fi.com/angel_wolf"}];function J(){S.useProxy(P.storage);const r=function(n){return a.url.openURL(n).catch(function(){})},i=function(n){return T?.getUser(n)||Object.values(T?.getUsers()).find(function(l){return l.id===n})||null},t=function(n){return i(n)?.getAvatarURL?.()?.replace("webp","png")||null},e=function(n){return a.React.createElement(N,{source:{uri:n},style:{width:40,height:40,borderRadius:20}})};return a.React.createElement(a.React.Fragment,null,a.React.createElement(H,null,a.React.createElement(R,{title:"Developers"},K.map(function(n,l){const s=t(n?.uuid);return a.React.createElement(p,{key:l,label:n.name,subLabel:n.role,leading:s?e(s):null})})),a.React.createElement(R,{title:"Testers"},Y.map(function(n,l){const s=t(n?.uuid);return a.React.createElement(p,{key:l,label:n.name,subLabel:n.role,leading:s?e(s):null})})),a.React.createElement(F,null),a.React.createElement(R,{title:"Support & Source"},a.React.createElement(B,{style:{margin:50}},q.map(function(n,l){let s=n.icon?n.icon?.startsWith("https")?a.React.createElement(N,{source:{uri:n.icon},style:{width:120,height:40}}):a.React.createElement(p.Icon,{source:E.getAssetIDByName(n.icon)}):null;return a.React.createElement(p,{key:l,label:n.label,leading:s,trailing:a.React.createElement(W,null),onPress:function(){return r(n.url)}})}))),a.React.createElement(F,null),a.React.createElement(B,{style:{height:40}})))}const{FormRow:$}=y.Forms;function X(){S.useProxy(P.storage);const r=a.NavigationNative.useNavigation(),i=function(){r.push("VendettaCustomPage",{title:"Credits & Support",render:function(){return a.React.createElement(J)}})};return a.React.createElement(a.React.Fragment,null,a.React.createElement($,{label:"CREDITS",subLabel:"See the people behind the plugin and ways to support its development.",onPress:i,trailing:a.React.createElement($.Icon,{source:E.getAssetIDByName("ic_arrow_right")})}))}const ee=c.findByStoreName("UserStore"),te=ee?.getCurrentUser?.()?.id;async function ne(r){let i=[];try{const t=await m.safeFetch(r);t.ok&&(i=(await t.json())?.list??[])}catch(t){b.logger.info("No Data",t)}return{list:i}}function ae(r,i=10){r?.list?.some(function(t){return String(t)===String(te)})&&setTimeout(function(){b.logger.info("[INFO] You are blacklisted from using this plugin."),k.removePlugin(b.plugin.id)},i*1e3)}const _=function(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")};u.isEnabled=!1;const re=new Map;let C;const ie=[[Z,[re]],[V,[]],[j,[]]],se=function(){return ie.forEach(function([r,i]){return r(...i)})},le="https://angelix1.github.io/static_list/antied/list.json";C=se();var ce={onLoad:async function(){const r=await ne(le);ae(r,15),u.isEnabled=!0},onUnload:function(){u.isEnabled=!1,C?.()},settings:X};return u.default=ce,u.regexEscaper=_,Object.defineProperty(u,"__esModule",{value:!0}),u})({},vendetta.patcher,vendetta.metro,vendetta.ui.toasts,vendetta.metro.common,vendetta.ui.assets,vendetta.utils,vendetta.storage,vendetta.plugin,vendetta.ui.components,vendetta,vendetta.plugins);
