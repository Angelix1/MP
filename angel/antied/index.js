(function(x,D,m,I,$,f,Ge,t,r,Y,F,h,je){"use strict";function Xe(a){var s=Object.create(null);return a&&Object.keys(a).forEach(function(e){if(e!=="default"){var o=Object.getOwnPropertyDescriptor(a,e);Object.defineProperty(s,e,o.get?o:{enumerable:!0,get:function(){return a[e]}})}}),s.default=a,Object.freeze(s)}var We=Xe(f);const{openLazy:Je,hideActionSheet:$a}=m.findByProps("openLazy","hideActionSheet");function ue(a,s){if(a!=null&&s!=null)for(const e of Object.keys(s))typeof s[e]=="object"&&!Array.isArray(s[e])?(typeof a[e]!="object"&&(a[e]={}),ue(a[e],s[e])):a[e]??(a[e]=s[e])}function Qe(a,s){try{Je(new Promise(function(e){return e({default:a})}),"ActionSheet",s)}catch(e){D.logger.error(e.stack),showToast("Got error when opening ActionSheet! Please check debug logs")}}const qe=function(a,s){return`${a}${Math.floor(s*255).toString(16).padStart(2,0)}`},J={toInt(a){return a=a.replace(/^#/,""),parseInt(a,16)},toHex(a){return"#"+a.toString(16).toUpperCase()},HSLtoHEX(a,s,e){e/=100;const o=s*Math.min(e,1-e)/100,n=function(l){const i=(l+a/30)%12,d=e-o*Math.max(Math.min(i-3,9-i,1),-1);return Math.round(255*d).toString(16).padStart(2,"0")};return`#${n(0)}${n(8)}${n(4)}`}};function ge(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return{version:a,new:s,updated:e,fix:o}}const T={...I.General,...I.Forms},Ke="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mJsrQAAAgwBAJ9P6qYAAAAASUVORK5CYII=",Ze={toPercentage:function(a){return a=Number(a),a===0?0:a===1?100:Math.round(a*100)},toDecimal:function(a){a=Number(a);const s=Math.min(Math.max(a,0),100);return s===0?0:s===100?1:s/100},formatDecimal:function(a){return a=Number(a),a===0||a===1?a:a.toFixed(2)},alphaToHex:function(a){a=Number(a);const s=Math.min(Math.max(a,0),100),e=Math.round(s/100*255).toString(16).toUpperCase();return e.length===1?"0"+e:e},hexAlphaToPercent:function(a){const s=parseInt(a,16);return isNaN(s)?0:Math.round(s/255*100)}};m.findByProps("openLazy","hideActionSheet");const fe=m.findByProps("getChannel","getDMFromUserId"),et=m.findByProps("_channelMessages"),tt=m.findByProps("getMessage","getMessages");function at(a){return $.before("dispatch",t.FluxDispatcher,function(s){const[e]=s,o=e?.type;if(r.storage.debug&&console.log("[ANTIED fluxdispatcher]",e),o=="MESSAGE_DELETE"){if(r.storage.switches.enableMD==!1||e?.otherPluginBypass)return s;const n=et.get(e.channelId)?.get(e.id);if(!n||e?.id&&a[e?.id]?.stage==2)return s;if(e?.id&&a[e?.id]?.stage==1)return a[e?.id].stage=2,a[e?.id]?.message??s;const l=n?.author?.id,i=n?.author?.username,d=!n?.content&&n?.attachments?.length==0&&n?.embeds?.length==0;if(!l||!i||d||r.storage?.switches?.ignoreBots&&n?.author?.bot||r.storage?.inputs?.ignoredUserList?.length>0&&r.storage.inputs.ignoredUserList?.some(function(g){return g?.id==n?.author?.id||g.username==n.author.username}))return s;const p=fe?.getChannel(n?.channel_id)?.guild_id;let c={...n,content:n?.content,type:0,channel_id:n?.channel_id||e?.channelId,guild_id:p,timestamp:`${new Date().toJSON()}`,state:"SENT",was_deleted:!0};return r.storage?.switches?.useEphemeralForDeleted&&(c.flags=64),s[0]={type:"MESSAGE_UPDATE",channelId:n?.channel_id||e?.channelId,message:c,optimistic:!1,sendMessageOptions:{},isPushNotification:!1},a[e?.id||n?.id]={message:s,stage:1},s}if(o=="MESSAGE_UPDATE"){if(r.storage.switches.enableMU==!1||e?.otherPluginBypass||e?.message?.author?.bot)return s;const n=tt.getMessage(e?.message?.channel_id||e?.channelId,e?.message?.id||e?.id),l=n?.author?.id,i=n?.author?.username,d=!n?.content&&n?.attachments?.length==0&&n?.embeds?.length==0;if(!n||!l||!i||d||!e?.message?.content||!n?.content||e?.message?.content==n?.content||r.storage?.inputs?.ignoredUserList?.length>0&&r.storage?.inputs?.ignoredUserList?.some(function(y){return y?.id==n?.author?.id||y?.username==n?.author?.username}))return s;let p=r.storage?.inputs?.editedMessageBuffer||"`[ EDITED ]`";const c=function(y){return`${y}

`},g=e?.message||n;let R=`${n?.content}`;if(r.storage?.switches?.addTimestampForEdits){const y=Date.now(),S=["t","T","d","D","f","F","R"].some(function(b){return b==r.storage.switches.timestampStyle})?r.storage.switches.timestampStyle:"R",u=`<t:${Math.abs(Math.round(y/1e3))}:${S}>`;if(r.storage?.misc?.timestampPos=="BEFORE"){const b=`${c(`(${u}) ${p}`)}${e?.message?.content??""}`;R+=`  ${b}`}else{const b=`${c(`${p} (${u})`)}${e?.message?.content??""}`;R+=`  ${b}`}}else R+=`  ${c(p)}${e?.message?.content??""}`;const A=fe.getChannel(e?.channelId||e?.message?.channel_id||n?.channel_id)?.guild_id;return s[0]={type:"MESSAGE_UPDATE",message:{...g,content:R,guild_id:A,edited_timestamp:"invalid_timestamp"}},s}return s})}const st=m.findByProps("startEditMessage");function rt(){return $.before("startEditMessage",st,function(a){let s=r.storage?.inputs?.editedMessageBuffer||"`[ EDITED ]`";const e=W(s),o=new RegExp(`(?:(?:\\s${e}(\\s\\(<t:\\d+:[tTdDfFR]>\\))?\\n{2})|(?:(?:\\s\\(<t:\\d+:[tTdDfFR]>\\) ${e}\\n{2})))`,"gm"),[n,l,i]=a,d=i.split(o);return a[2]=d[d.length-1],a})}const{DCDChatManager:nt}=t.ReactNative.NativeModules;function ot(a){return $.before("updateRows",nt,function(s){let e=JSON.parse(s[1]);const{textColor:o,backgroundColor:n,backgroundColorAlpha:l,gutterColor:i,gutterColorAlpha:d}=r.storage.colors,p=r.storage.inputs?.deletedMessageBuffer,{useBackgroundColor:c,minimalistic:g,removeDismissButton:R}=r.storage.switches;function A(u,b){u||(u=b);const E=u?.trim();if(E.startsWith("#")){const P=E.slice(1);if(/^[0-9A-Fa-f]{6}$/.test(P))return"#"+P.toUpperCase()}else if(/^[0-9A-Fa-f]{6}$/.test(E))return"#"+E.toUpperCase();return b||"#000"}function y(u,b){const E=b?.toString(),P=["text","heading","s","u","em","strong","list","blockQuote"];if(Array.isArray(u))return u.map(function(M){return y(M,E)});if(typeof u=="object"&&u!==null){const{content:M,type:B,target:w,items:_}=u;if(!P.includes(B))return u;if(B==="text"&&M&&M.length>=1)return{content:[{content:M,type:"text"}],target:"usernameOnClick",type:"link",context:{username:1,medium:!0,usernameOnClick:{action:"0",userId:"0",linkColor:t.ReactNative.processColor(E),messageChannelId:"0"}}};const H=y(M,E),Ye=_?_.map(y,E):void 0;if(H!==M||Ye!==_||!P.includes(B)){const U={...u,content:H};return B==="blockQuote"&&w&&(U.content=H,U.target=w),B==="list"&&U?.content&&delete U.content,_&&(U.items=Ye),U}}return u}function S(u,b,E){return u&&u.content[0].content.splice(1),u}return e.forEach(function(u){if(r.storage.debug&&console.log(u),u?.type==1&&a[u?.message?.id]){if((p?.length>0||p!="")&&(u.message.edited=p),g==!1){const b=A(o,"#E40303"),E=y(u?.message?.content,b);u.message.content=E}if(R&&u?.message?.ephemeralIndication&&(u.message.ephemeralIndication=S(u.message.ephemeralIndication)),g==!1&&c==!0){const b=A(`${n}`,"#FF2C2F"),E=A(`${i}`,"#FF2C2F");u.backgroundHighlight??(u.backgroundHighlight={}),u.backgroundHighlight={backgroundColor:t.ReactNative.processColor(`${b}${l}`),gutterColor:t.ReactNative.processColor(`${E}${d}`)}}}}),s[1]=JSON.stringify(e),s[1]})}const lt=m.findByProps("updateMessageRecord","createMessageRecord");function it(){return $.after("createMessageRecord",lt,function(a,s){let[e]=a;s.was_deleted=e.was_deleted})}const ct=m.findByName("MessageRecord",!1);function dt(){return $.after("default",ct,function(a,s){let[e]=a;s.was_deleted=!!e.was_deleted})}const me=m.findByProps("updateMessageRecord","createMessageRecord");function ut(){return $.instead("updateMessageRecord",me,function(a,s){let[e,o]=a;return o.was_deleted?me.createMessageRecord(o,e.reactions):s.apply(this,[e,o])})}const Q=m.findByProps("openLazy","hideActionSheet"),gt=m.findByProps("getMessage","getMessages"),he=m.findByProps("getChannel","getDMFromUserId"),{ActionSheetRow:G}=m.findByProps("ActionSheetRow");function ft(a){return $.before("openLazy",Q,function(s){let[e,o,n]=s;const l=n?.message;o!=="MessageLongPressActionSheet"||!l||e.then(function(i){const d=$.after("default",i,function(p,c){t.React.useEffect(function(){return function(){d()}},[]),r.storage.debug&&console.log("[ANTIED ActionSheet]",l);const g=Ge.findInReactTree(c,function(S){return S?.find?.(function(u){return u?.props?.label==t.i18n?.Messages?.MESSAGE_ACTION_REPLY})});if(!g)return c;const R=Math.max(g.findIndex(function(S){return S?.props?.label==t.i18n?.Messages?.MESSAGE_ACTION_REPLY}),g.length-1),A=gt.getMessage(l.channel_id,l?.id),y=W(r.storage?.inputs?.editedMessageBuffer||"`[ EDITED ]`");if(new RegExp(y,"gmi").test(l.content)){const S=R||1;g.splice(S,0,t.React.createElement(G,{label:"Remove Edit History",subLabel:`Added by ${ce(D.plugin?.manifest?.name)||"ANTIED"}`,icon:t.React.createElement(G.Icon,{source:f.getAssetIDByName("ic_edit_24px")}),onPress:function(){let u=r.storage?.inputs?.editedMessageBuffer||"`[ EDITED ]`";const b=W(u),E=new RegExp(`(?:(?:\\s${b}(\\s\\(<t:\\d+:[tTdDfFR]>\\))?\\n{2})|(?:(?:\\s\\(<t:\\d+:[tTdDfFR]>\\) ${b}\\n{2})))`,"gm"),P=l?.content?.split(E);r.storage.debug&&console.log([[u],l?.content?.split(E),P]);const M=P[P.length-1],B=l?.embeds?.map(function(w){const _=w?.color?.replace(/.+\(/,"")?.replace(/%/g,"")?.replace(")","")?.split(", "),H=t.ReactNative.processColor(`${qe(J.HSLtoHEX(_[0],_[1],_[2]),_[3])}`);return{...w,author:w.author,title:w.rawTitle,description:w.rawDescription,url:w.url,type:w.type,image:w.image,thumbnail:w.thumbnail,color:H,content_scan_version:1}});t.FluxDispatcher.dispatch({type:"MESSAGE_UPDATE",message:{...l,content:`${M}`,embeds:B??[],attachments:l.attachments??[],mentions:l.mentions??[],guild_id:he.getChannel(A.channel_id).guild_id},otherPluginBypass:!0}),Q.hideActionSheet(),(r.storage?.inputs?.historyToast?.length>0||r.storage?.inputs?.historyToast!="")&&Y.showToast(r.storage?.inputs?.historyToast?.toString?.(),f.getAssetIDByName(r.storage?.misc?.editHistoryIcon||"ic_edit_24px"))}}))}if(r.storage.debug&&console.log("[ANTIED ActionSheet]","useEphemeralForDeleted",!r.storage?.switches?.useEphemeralForDeleted,"msgExist?",!!a[l.id]),!r.storage?.switches?.useEphemeralForDeleted&&a[l.id]){const S=R||1;g.splice(S,0,t.React.createElement(G,{label:"Remove Deleted Message",subLabel:`Added by ${ce(D.plugin?.manifest?.name)||"ANTIED"}`,isDestructive:!0,icon:t.React.createElement(G.Icon,{source:f.getAssetIDByName("ic_edit_24px")}),onPress:function(){t.FluxDispatcher.dispatch({type:"MESSAGE_DELETE",guildId:he.getChannel(A.channel_id).guild_id,id:l?.id,channelId:l?.channel_id,otherPluginBypass:!0}),Q.hideActionSheet(),(r.storage?.inputs?.historyToast?.length>0||r.storage?.inputs?.historyToast!="")&&Y.showToast("[ANTIED] Message Removed",f.getAssetIDByName("ic_edit_24px"))}}))}})})})}const{View:mt,FormRow:ht,FormIcon:Rt,FormSwitch:pt,FormDivider:bt}=T,Re=[{id:"enableMD",default:!0,label:"Toggle Message Delete",subLabel:"Logs deleted message"},{id:"enableMU",default:!0,label:"Toggle Message Update",subLabel:"Logs edited message"}];function Et(a){let{styles:s}=a;return F.useProxy(r.storage),React.createElement(React.Fragment,null,React.createElement(mt,{style:[s.subText]},Re?.map(function(e,o){return React.createElement(React.Fragment,null,React.createElement(ht,{label:e?.label,subLabel:e?.subLabel,leading:e?.icon&&React.createElement(Rt,{style:{opacity:1},source:f.getAssetIDByName(e?.icon)}),trailing:"id"in e?React.createElement(pt,{value:r.storage?.switches[e?.id]??e?.default,onValueChange:function(n){return r.storage.switches[e?.id]=n}}):void 0}),o!==Re?.length-1&&React.createElement(bt,null))})))}const{FormRow:yt,FormIcon:Ct,View:wt,FormInput:q,FormDivider:K}=T,pe=[{id:"deletedMessageBuffer",title:"Customize Deleted Message",type:"default",placeholder:"This message is deleted"},{id:"editedMessageBuffer",title:"Customize Edited Separator",type:"default",placeholder:"`[ EDITED ]`"},{id:"historyToast",title:"Customize Remove History Toast Message",type:"default",placeholder:"History Removed"}];function At(a){let{styles:s}=a;return F.useProxy(r.storage),React.createElement(React.Fragment,null,React.createElement(wt,{style:[s.subText]},pe?.map(function(e,o){return React.createElement(React.Fragment,null,React.createElement(q,{title:e?.title,keyboardType:e?.type,placeholder:e?.placeholder?.toString(),value:r.storage?.inputs[e.id]??e?.placeholder,onChange:function(n){return r.storage.inputs[e.id]=n.toString()}}),o!==pe.length-1&&React.createElement(K,null))}),React.createElement(q,{title:"Customize Plugin Name",keyboardType:"default",placeholder:r.storage?.inputs?.customPluginName||D.plugin?.manifest?.name||"ANTIED",value:r.storage?.inputs?.customPluginName,onChange:function(e){r.storage.inputs.customPluginName=e.toString(),D.plugin.manifest.name=e.toString()}}),React.createElement(K,null),React.createElement(yt,{label:`Current Used Icon - ${r.storage?.misc?.editHistoryIcon||"ic_edit_24px"}`,subLabel:"Icon for Message History Removed toast",trailing:React.createElement(Ct,{style:{opacity:1},source:f.getAssetIDByName(r.storage?.misc?.editHistoryIcon)})}),React.createElement(K,null),React.createElement(q,{title:"Icon Name",keyboardType:"default",placeholder:"ic_edit_24px",value:r.storage?.misc?.editHistoryIcon||"ic_edit_24px",onChange:function(e){return r.storage.misc.editHistoryIcon=e.toString()}})))}const{FormRow:St}=T,Dt=m.findByName("RowCheckmark");function Z(a){let{label:s,subLabel:e,selected:o,onPress:n}=a;return React.createElement(St,{label:s,subLabel:e,trailing:React.createElement(Dt,{selected:o}),onPress:n})}const be=[{type:"t",label:"Short Time",subLabel:"16:20"},{type:"T",label:"Long Time",subLabel:"16:20:30"},{type:"d",label:"Short Date",subLabel:"20/04/2021"},{type:"D",label:"Long Date",subLabel:"20 April 2021"},{type:"f",label:"Short Date/Time",subLabel:"20 April 2021 16:20"},{type:"F",label:"Long Date/Time",subLabel:"Tuesday, 20 April 2021 16:20"},{type:"R",label:"Relative Time",subLabel:"2 months ago"}],Ee=[{label:"Before",subLabel:"Old Message (2 minutes ago) [Edited] New Message",key:"BEFORE"},{label:"After",subLabel:"Old Message [Edited] (2 minutes ago) New Message",key:"AFTER"}],{FormRow:ye,FormDivider:ee}=T;function Ft(){return F.useProxy(r.storage),React.createElement(React.Fragment,null,React.createElement(ye,{label:"Timestamp Style"}),be.map(function(a,s){let{type:e,label:o,subLabel:n}=a;return React.createElement(React.Fragment,null,React.createElement(Z,{label:o,subLabel:`Example: ${n}`,selected:r.storage.switches.timestampStyle==e,onPress:function(){return r.storage.switches.timestampStyle=e}}),s!==be.length-1&&React.createElement(ee,null))}),React.createElement(ee,null),React.createElement(ye,{label:"Timestamp Position"}),Ee.map(function(a,s){let{key:e,label:o,subLabel:n}=a;return React.createElement(React.Fragment,null,React.createElement(Z,{label:o,subLabel:`Example: ${n}`,selected:r.storage.misc?.timestampPos==e,onPress:function(){return r.storage.misc.timestampPos=e}}),s!==Ee.length-1&&React.createElement(ee,null))}))}const It=Object.keys(h.semanticColors).map(function(a){return`semanticColors.${a}`}),Tt=Object.keys(h.rawColors).map(function(a){return`rawColors.${a}`}),Ce=[...It,...Tt],{FormRow:Pt,FormDivider:Mt,ScrollView:_t}=T;function $t(){return F.useProxy(r.storage),React.createElement(React.Fragment,null,React.createElement(_t,null,React.createElement(Pt,{label:"Choose Color"}),Ce.map(function(a,s){return React.createElement(React.Fragment,null,React.createElement(Z,{label:a,selected:r.storage.colors.semRawColorPrefix==a,onPress:function(){return r.storage.colors.semRawColorPrefix=a}}),s!==Ce.length-1&&React.createElement(Mt,null))})))}const Lt=m.findByName("CustomColorPickerActionSheet"),{alphaToHex:te,hexAlphaToPercent:we,toPercentage:O,toDecimal:Ae,formatDecimal:Se}=Ze,{View:V,FormRow:z,FormSwitch:Bt,FormSliderRow:De,FormDivider:xt,Text:Fe,TouchableOpacity:Nt,Image:vt}=T,Ie=[{id:"textColor",label:"Deleted Message Text Color",subLabel:"Click to customize Deleted Message Text Color",defaultColor:"#E40303"},{id:"backgroundColor",label:"Deleted Message Background Color",subLabel:"Click to customize Background Color",defaultColor:"#FF2C2F"},{id:"gutterColor",label:"Deleted Message Background Gutter Color",subLabel:"Click to customize Background Gutter Color",defaultColor:"#FF2C2F"}];function kt(a){let{styles:s}=a;F.useProxy(r.storage);const[e,o]=t.React.useState(Ae(we(r.storage?.colors?.backgroundColorAlpha)??100)),[n,l]=t.React.useState(Ae(we(r.storage?.colors?.gutterColorAlpha)??100)),i=t.NavigationNative.useNavigation(),d=function(c){return te(O(c))},p=function(c){if(!c)return null;const[g,R]=c.split(".");return g=="semanticColors"?h.semanticColors[R]:h.rawColors[R]};return t.React.createElement(t.React.Fragment,null,t.React.createElement(V,{style:[s.subText]},r.storage?.switches?.useSemRawColors&&t.React.createElement(t.React.Fragment,null,t.React.createElement(z,{label:"Semantic & Raw Colors",subLabel:"If you enabled [Use Semantic/Raw Color], you can pick the colors from here",leading:t.React.createElement(z.Icon,{source:f.getAssetIDByName("ic_audit_log_24px")}),trailing:z.Arrow,onPress:function(){return i.push("VendettaCustomPage",{title:"Semantic & Raw Colors",render:function(){return t.React.createElement($t,null)}})}})),Ie?.map(function(c){const g=function(){return Qe(Lt,{color:J?.toInt(r.storage.colors[c.id]||c?.defaultColor||"#000"),onSelect:function(R){const A=J?.toHex(R);r.storage.colors[c.id]=A}})};return t.React.createElement(t.React.Fragment,null,t.React.createElement(z,{label:c?.label,subLabel:c?.subLabel||"Click to Update",onPress:g,trailing:t.React.createElement(Nt,{onPress:g},t.React.createElement(vt,{source:{uri:Ke},style:{width:32,height:32,borderRadius:10,backgroundColor:r.storage?.colors[c.id]||Ie.find(function(R){return R?.id==c?.id})?.defaultColor||"#000"}}))}))}),t.React.createElement(V,{style:s.container},t.React.createElement(z,{style:{justifyContent:"center",alignItems:"center"},label:`Preview Style: ${r.storage?.switches?.darkMode?"Dark":"Light"} Mode`,subLabel:"Click to Switch Mode",trailing:t.React.createElement(Bt,{value:r.storage?.switches?.darkMode??!0,onValueChange:function(c){return r.storage.switches.darkMode=c}})}),t.React.createElement(V,{style:[s.row,s.border,{overflow:"hidden",marginRight:10}]},t.React.createElement(V,{style:{width:"2%",backgroundColor:`${r.storage.colors.gutterColor}${d(n)}`}}),t.React.createElement(V,{style:{flex:1,backgroundColor:`${r.storage.switches.useSemRawColors&&p(r.storage?.colors?.semRawColorPrefix)||r.storage.colors.backgroundColor}${d(e)}`,justifyContent:"center",alignItems:"center"}},t.React.createElement(Fe,{style:{fontSize:20,color:r.storage?.switches?.darkMode?"white":"black"}}," Low Effort Normal Example Message "),t.React.createElement(Fe,{style:{fontSize:20,color:r.storage.colors.textColor||"#000000"}}," Low Effort Deleted Example Message "))),t.React.createElement(De,{label:`Background Color Alpha: ${O(e)}%`,value:e,style:{width:"90%"},onValueChange:function(c){o(Number(Se(c))),r.storage.colors.backgroundColorAlpha=te(O(c))}}),t.React.createElement(xt,null),t.React.createElement(De,{label:`Background Gutter Alpha: ${O(n)}%`,value:n,style:{width:"90%"},onValueChange:function(c){l(Number(Se(c))),r.storage.colors.gutterColorAlpha=te(O(c))}}))))}const{ScrollView:Ut,View:ae,Text:Ot,TouchableOpacity:Te,TextInput:La,Image:Vt,Animated:j}=I.General,{FormLabel:zt,FormIcon:Ht,FormArrow:Ba,FormRow:se,FormSwitch:Yt,FormSwitchRow:xa,FormSection:Gt,FormDivider:jt,FormInput:Pe}=I.Forms,Xt=m.findByName("useIsFocused");m.findByProps("BottomSheetScrollView");const Me=m.findByStoreName("UserStore"),_e=m.findByProps("showUserProfile");f.getAssetIDByName("ic_add_24px"),f.getAssetIDByName("ic_arrow"),f.getAssetIDByName("ic_minus_circle_24px"),f.getAssetIDByName("Check"),f.getAssetIDByName("Small");function $e(a){return t.React.createElement(Ht,{style:{opacity:1},source:f.getAssetIDByName(a)})}const L=t.stylesheet.createThemedStyleSheet({basicPad:{paddingRight:10,marginBottom:10,letterSpacing:.25},header:{color:h.semanticColors.HEADER_PRIMARY,fontFamily:t.constants.Fonts.DISPLAY_BOLD,fontSize:25,paddingLeft:"3%",letterSpacing:.25},sub:{color:h.semanticColors.TEXT_POSITIVE,fontFamily:t.constants.Fonts.DISPLAY_NORMAL,paddingLeft:"4%",fontSize:18},flagsText:{color:h.semanticColors.HEADER_SECONDARY,fontFamily:t.constants.Fonts.PRIMARY_BOLD,paddingLeft:"4%",fontSize:16},container:{marginTop:25,marginLeft:"5%",marginBottom:-15,flexDirection:"row"},textContainer:{paddingLeft:15,paddingTop:5,flexDirection:"column",flexWrap:"wrap",shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:.2,shadowRadius:4.65,elevation:8},image:{width:75,height:75,borderRadius:10,shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:.2,shadowRadius:4.65,elevation:8},mainText:{opacity:.975,letterSpacing:.25},subHeader:{color:h.semanticColors.HEADER_SECONDARY,fontSize:12.75}});function Le(a){let{index:s}=a;F.useProxy(r.storage);let e=r.storage?.inputs?.ignoredUserList[s];const o=t.React.useRef(new j.Value(1)).current,n=function(){return j.spring(o,{toValue:1.1,duration:10,useNativeDriver:!0}).start()},l=function(){return j.spring(o,{toValue:1,duration:250,useNativeDriver:!0}).start()},i={transform:[{scale:o}]};let d=Me.getUser(e?.id),p=Object.values(Me.getUsers());d||(d=p.find(function(g){return g?.username==e?.username})),d||(d=p.find(function(g){return g?.username?.toLowerCase()==e?.username?.toLowerCase()}));const c=t.NavigationNative.useNavigation();return Xt(),t.React.createElement(t.React.Fragment,null,t.React.createElement(Ut,null,t.React.createElement(ae,{style:[L.basicPad,L.sub]},t.React.createElement(Gt,{title:"User Setting",style:[L.header]},t.React.createElement(se,{label:"Find User Id or Username",leading:$e("ic_search"),onPress:function(){d&&!e.username?.length?e.username=d.username:d&&!e.id?.length?e.id=d.id:Y.showToast("Cannot find User Id/Username.")}}),t.React.createElement(Pe,{title:"User Username | Case Sensitive",placeholder:"Missing No",value:e?.username,onChange:function(g){return e.username=g}}),t.React.createElement(Pe,{title:"User Id",placeholder:"Missing No",value:e?.id,onChange:function(g){return e.id=g}}),t.React.createElement(se,{label:"User is webhook?",subLabel:"User is webhook or system, and not BOT or Normal User.",leading:$e("ic_webhook_24px"),trailing:t.React.createElement(Yt,{value:e?.isWebhook||!1,onValueChange:function(g){return e.isWebhook=g}})})),d&&t.React.createElement(ae,{style:[L.container,{paddingBottom:10}]},t.React.createElement(Te,{onPress:function(){return _e.showUserProfile?.({userId:d?.id})},onPressIn:n,onPressOut:l},t.React.createElement(j.View,{style:i},t.React.createElement(Vt,{source:{uri:d?.getAvatarURL?.()?.replace?.("webp","png")||"https://cdn.discordapp.com/embed/avatars/2.png"},style:{width:128,height:128,borderRadius:10}}))),t.React.createElement(ae,{style:L.textContainer},t.React.createElement(Te,{onPress:function(){return _e.showUserProfile({userId:d?.id})}},t.React.createElement(Ot,{style:[L.mainText,L.header]},d?.username||e?.username||"No Name"))),t.React.createElement(jt,null)),t.React.createElement(se,{label:t.React.createElement(zt,{text:"Remove User from Ignore List",style:{color:h.rawColors.RED_400}}),onPress:function(){c.pop(),r.storage?.inputs?.ignoredUserList?.splice(s,1)}}))))}const{ScrollView:Wt,View:Jt,Text:Na,TouchableOpacity:Qt,TextInput:qt}=I.General,{FormLabel:va,FormIcon:Kt,FormArrow:Zt,FormRow:re,FormSwitch:ka,FormSwitchRow:Ua,FormSection:ea,FormDivider:ta,FormInput:Oa}=I.Forms;function Be(a,s){return t.React.createElement(Kt,{style:{opacity:1},source:a})}const aa=m.findByName("useIsFocused");m.findByProps("BottomSheetScrollView");const{getUser:sa}=m.findByProps("getUser"),ra=f.getAssetIDByName("ic_add_24px");f.getAssetIDByName("ic_arrow"),f.getAssetIDByName("ic_minus_circle_24px"),f.getAssetIDByName("Check"),f.getAssetIDByName("Small");const na=f.getAssetIDByName("ic_trash_24px"),N=t.stylesheet.createThemedStyleSheet({basicPad:{paddingRight:10,marginBottom:10,letterSpacing:.25},header:{color:h.semanticColors.HEADER_SECONDARY,fontFamily:t.constants.Fonts.PRIMARY_BOLD,paddingLeft:"3.5%",fontSize:24},sub:{color:h.semanticColors.TEXT_POSITIVE,fontFamily:t.constants.Fonts.DISPLAY_NORMAL,paddingLeft:"4%",fontSize:18},flagsText:{color:h.semanticColors.HEADER_SECONDARY,fontFamily:t.constants.Fonts.PRIMARY_BOLD,paddingLeft:"4%",fontSize:16},input:{fontSize:16,fontFamily:t.constants.Fonts.PRIMARY_MEDIUM,color:h.semanticColors.TEXT_NORMAL},placeholder:{color:h.semanticColors.INPUT_PLACEHOLDER_TEXT}});function oa(){F.useProxy(r.storage);let[a,s]=t.React.useState("");const e=t.NavigationNative.useNavigation();aa();let o=r.storage?.inputs?.ignoredUserList??[];const n=function(){if(a){if(isNaN(parseInt(a)))o.push({id:void 0,username:a});else{let l=sa(a);if(l)o.push({id:l?.id,username:"",showUser:!1,isWebhook:!1});else return Y.showToast("Invalid User Id")}s(""),e.push("VendettaCustomPage",{title:"Adding User to Ignore List",render:function(){return t.React.createElement(Le,{index:o?.length-1})}})}};return t.React.createElement(t.React.Fragment,null,t.React.createElement(Wt,{style:{flex:1}},t.React.createElement(ea,{style:[N.header,N.basicPad]},t.React.createElement(Jt,{style:[N.header,N.sub]},o.length>0&&t.React.createElement(re,{label:"Clear List",trailing:Be(na),onPress:function(){o.length!==0&&je.showConfirmationAlert({title:"Hol up, wait a minute!",content:`This will removes in total ${o.length} users from ignore list.`,confirmText:"Ye",cancelText:"Nah",confirmColor:"brand",onConfirm:function(){r.storage.inputs.ignoredUserList=[]}})}}),o?.map(function(l,i){return t.React.createElement(t.React.Fragment,null,t.React.createElement(re,{label:l?.username||l?.id||"No Data",trailing:t.React.createElement(Zt,null),onPress:function(){return e.push("VendettaCustomPage",{title:"Editing User",render:function(){return t.React.createElement(Le,{index:i})}})}}),i!==o?.length-1&&t.React.createElement(ta,null))}),t.React.createElement(re,{label:t.React.createElement(qt,{value:a,onChangeText:s,placeholder:"User ID or Username",placeholderTextColor:N.placeholder.color,selectionColor:t.constants.Colors.PRIMARY_DARK_100,onSubmitEditing:n,returnKeyType:"done",style:N.input}),trailing:t.React.createElement(Qt,{onPress:n},Be(ra))})))))}const{FormRow:la,FormDivider:ia,FormIcon:xe,TouchableOpacity:ca}=T;function da(){F.useProxy(r.storage);const a=t.NavigationNative.useNavigation(),s=function(){a.push("VendettaCustomPage",{title:"List of Ignored Users",render:function(){return React.createElement(oa,null)}})};return React.createElement(React.Fragment,null,React.createElement(la,{label:"Add User to List",subLabel:"List of ignored users for the plugin",leading:React.createElement(xe,{style:{opacity:1},source:f.getAssetIDByName("ic_members")}),onPress:s,trailing:React.createElement(ca,{onPress:s},React.createElement(xe,{style:{opacity:1},source:f.getAssetIDByName("ic_add_24px")}))}),React.createElement(ia,null))}const{View:ua,FormRow:ga,FormIcon:fa,FormSwitch:ma,FormDivider:ha}=T,Ra=m.findByName("HelpMessage"),Ne=[{id:"minimalistic",default:!0,label:"Minimalistic Settings",subLabel:"Removes all Styling (Enabled by Default)"},{id:"useBackgroundColor",default:!1,label:"Enable Background Color",subLabel:"Background Color for Deleted Message, similiar to Mention but Customizeable"},{id:"useSemRawColors",default:!1,label:"Use Semantic/Raw Color",subLabel:"Use Semantic/Raw Color instead of Custom Color for Background Color, doesn't applied to GutterColor"},{id:"ignoreBots",default:!1,label:"Ignore Bots",subLabel:"Ignore bot deleted messages."},{id:"removeDismissButton",default:!1,label:"Remove Dissmiss Message",subLabel:"Remove clickable Dismiss Message text from deleted ephemeral messages."},{id:"addTimestampForEdits",default:!1,label:"Add Edit Timestamp",subLabel:"Add Timestamp for edited messages."},{id:"useEphemeralForDeleted",default:!0,label:"Use Ephemeral for Deleted",subLabel:"When messages got deleted it'll use ephemeral instead of normal message (Enabled by Default)."}];function pa(a){let{styles:s}=a;return F.useProxy(r.storage),React.createElement(React.Fragment,null,React.createElement(ua,{style:[s.subText]},r.storage?.switches.minimalistic&&React.createElement(Ra,{messageType:0},'To use styling, disable "Minimalistic" option'),Ne?.map(function(e,o){return React.createElement(React.Fragment,null,React.createElement(ga,{label:e?.label,subLabel:e?.subLabel,leading:e?.icon&&React.createElement(fa,{style:{opacity:1},source:f.getAssetIDByName(e?.icon)}),trailing:"id"in e?React.createElement(ma,{value:r.storage?.switches[e?.id]??e?.default,onValueChange:function(n){return r.storage.switches[e?.id]=n}}):void 0}),o!==Ne?.length-1&&React.createElement(ha,null))})))}function v(){for(var a=arguments.length,s=new Array(a),e=0;e<a;e++)s[e]=arguments[e];return[...s]}var ne=[ge("1.2.0 - 1.2.5",v("[1.2.0] Added Update Section","[1.2.2] Added Support for Semantic Colors","[1.2.2] Added Support for Raw Colors","[1.2.2] Added Support for Timestamp Format","[1.2.5] Added option useEphemeralForDeleted modification in Customize Section","[1.2.5] Added new button on actionMessage if useEphemeralForDeleted disabled"),v("[1.2.1] Redesign Setting Page","[1.2.2] Reworked how Message update appends separator","[1.2.4] Update Remove Edit button style"),v("[1.2.3] Fixed Remove Edit button to not persist under Edit Message Button","[1.2.4] Fixed Message Parser Fails to parse edited message")),ge("1.3",v("[1.3] Option to custom name the plugin","[1.3] Option to replace icon toast for edited history toast"),v("[1.3] Removes Logging system due crashes and inefficient code","[1.3] Removes patch to user setting to avoid crashes again"),v("[1.3] Hopefully fixed the issue with IOS crash on setting"))].reverse();const{ScrollView:za,View:ve,Text:Ha,TouchableOpacity:Ya,TextInput:Ga,Image:ja,Animated:Xa}=I.General,{FormLabel:Wa,FormIcon:ba,FormArrow:Ja,FormRow:oe,FormSwitch:Qa,FormSwitchRow:qa,FormSection:Ka,FormDivider:Ea,FormInput:Za}=I.Forms,ya=f.getAssetIDByName("ic_radio_square_checked_24px"),Ca=f.getAssetIDByName("ic_radio_square_24px"),wa=f.getAssetIDByName("ic_information_24px");f.getAssetIDByName("ic_info");const Aa=f.getAssetIDByName("premium_sparkles"),Sa=f.getAssetIDByName("ic_sync_24px"),Da=f.getAssetIDByName("ic_progress_wrench_24px"),k=t.stylesheet.createThemedStyleSheet({border:{borderRadius:10},textBody:{color:h.semanticColors.TEXT_NORMAL,fontFamily:t.constants.Fonts.PRIMARY_MEDIUM,letterSpacing:.25,fontSize:22},textBody:{color:h.semanticColors.INPUT_PLACEHOLDER_TEXT,fontFamily:t.constants.Fonts.DISPLAY_NORMAL,letterSpacing:.25,fontSize:16},versionBG:{margin:10,padding:15,backgroundColor:"rgba(55, 149, 225, 0.3)"},rowLabel:{margin:10,padding:15,backgroundColor:"rgba(33, 219, 222, 0.34)"}});function X(a){return t.React.createElement(ba,{style:{opacity:1},source:a})}function Fa(a){let{change:s,index:e,totalIndex:o}=a;const[n,l]=t.React.useState(!1);t.React.useState(!1);function i(d,p,c,g){return t.React.createElement(ve,null,t.React.createElement(oe,{label:p||"No Section",subLabel:c||null,leading:g&&X(g),style:[k.textHeader]}),d.map(function(R,A){return t.React.createElement(t.React.Fragment,null,t.React.createElement(oe,{label:R,style:[k.textBody,k.rowLabel,k.border]}))}))}return t.React.createElement(t.React.Fragment,null,t.React.createElement(I.ErrorBoundary,null,t.React.createElement(oe,{label:s?.version,leading:e==0?X(ya):X(Ca),trailing:X(wa),onPress:function(){l(!n)}}),n&&t.React.createElement(ve,{style:[k.versionBG,k.border]},s?.new?.length>0&&i(s.new,"New","New stuffies",Aa),s?.updated?.length>0&&i(s.updated,"Changes","Update things",Sa),s?.fix?.length>0&&i(s.fix,"Fixes","Me hate borken things",Da)),e==o.length-1?void 0:t.React.createElement(Ea,null)))}const{FormSwitch:ke,FormSection:Ue,FormRow:Oe,ScrollView:Ia,View:le,FormDivider:Ve,Animated:ie}=T,Ta=m.findByName("LinearGradient"),C=t.stylesheet.createThemedStyleSheet({text:{color:h.semanticColors.HEADER_SECONDARY,paddingLeft:"5.5%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:t.constants.Fonts.PRIMARY_BOLD,fontSize:16},subText:{color:h.semanticColors.TEXT_POSITIVE,paddingLeft:"6%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:t.constants.Fonts.DISPLAY_NORMAL,fontSize:12},input:{fontSize:16,fontFamily:t.constants.Fonts.PRIMARY_MEDIUM,color:h.semanticColors.TEXT_NORMAL},placeholder:{color:h.semanticColors.INPUT_PLACEHOLDER_TEXT},container:{flex:1,justifyContent:"center",alignItems:"center"},colorPreview:{width:"75%",height:100,marginBottom:20},row:{flexDirection:"row",height:80,width:"90%",marginBottom:20},border:{borderRadius:12},lnBorder:{borderRadius:12,overflow:"hidden"},shadowTemplate:{shadowOffset:{width:1,height:3},shadowOpacity:.9,shadowRadius:24,elevation:16},lnShadow:{flex:1,margin:"1%",shadowColor:"#b8ff34"},darkMask:{backgroundColor:"rgba(10, 10, 10, 0.9)",margin:2,padding:"3%"},padBot:{paddingBottom:20}});function Pa(){F.useProxy(r.storage);const[a]=t.React.useState(new ie.Value(0));t.React.useEffect(function(){ie.loop(ie.timing(a,{toValue:4,duration:8e3,useNativeDriver:!0})).start()},[]);const s={backgroundColor:a.interpolate({inputRange:[0,1,2,3,4],outputRange:["rgba(188,31,31,0.5)","rgba(46,168,30,0.5)","rgba(48,179,173,0.5)","rgba(183,40,198,0.5)","rgba(188,31,31,0.5)"]})},e=function(i,d,p,c,g,R){return{id:i,title:d,label:p,subLabel:c,props:g,propsData:R}},o=[e("patches","Plugin Patcher","Show Patches","Toggle what the plugin patch",Et,C),e("customize","Customization","Customize",null,pa,C),e("text","Text Variables","Customize Texts",null,At,C),e("timestamp","Timestamp","Timestamp Styles",null,Ft,C),e("colorpick","Colors","Customize Colors",null,kt,C),e("ingorelist","Ignore List","Show IngoreList",null,da,null)],n=t.ReactNative?.Platform?.OS||null,l=t.React.createElement(t.React.Fragment,null,t.React.createElement(le,{style:[C.lnBorder,s,C.darkMask]},o.map(function(i){return t.React.createElement(t.React.Fragment,null,t.React.createElement(Ue,{title:i?.title},t.React.createElement(Oe,{label:i?.label,subLabel:i?.subLabel,trailing:t.React.createElement(ke,{value:r.storage.setting[i?.id],onValueChange:function(d){r.storage.setting[i?.id]=d}})}),r.storage.setting[i.id]&&i.props&&t.React.createElement(le,{style:{margin:5,padding:10,borderRadius:10,backgroundColor:"rgba(0, 0, 0, 0.15)"}},t.React.createElement(i.props,{styles:i.propsData}))))}),t.React.createElement(Ve,null),t.React.createElement(Oe,{label:"Debug",subLabel:"Enable console logging",style:[C.padBot],trailing:t.React.createElement(ke,{value:r.storage.debug,onValueChange:function(i){r.storage.debug=i}})}),t.React.createElement(Ve,null),ne&&t.React.createElement(Ue,{title:"Updates"},t.React.createElement(le,{style:{margin:5,padding:5,borderRadius:10,backgroundColor:"rgba(59, 30, 55, 0.15)"}},ne.map(function(i,d){return t.React.createElement(Fa,{change:i,index:d,totalIndex:ne.length})})))));return t.React.createElement(t.React.Fragment,null,t.React.createElement(Ia,null,n=="android"?t.React.createElement(t.React.Fragment,null,t.React.createElement(Ta,{start:{x:.8,y:0},end:{x:0,y:.8},colors:["#b8ff34","#4bff61","#44f6ff","#4dafff","#413dff","#d63efd"],style:[C.lnBorder,C.shadowTemplate,C.lnShadow,C.padBot]},l)):l))}const ze=m.findByProps("_channelMessages"),W=function(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},ce=function(a){return a.replace(/\s?v\d+.\d+.\w+/,"")},Ma=Object.keys(We.all).map(function(a){return a?.name});ue(r.storage,{setting:{colorpick:!1,customize:!1,ingorelist:!1,patches:!1,text:!1,timestamp:!1},switches:{customizeable:!1,enableMD:!0,enableMU:!0,useBackgroundColor:!1,useSemRawColors:!1,ignoreBots:!1,minimalistic:!0,alwaysAdd:!1,darkMode:!0,removeDismissButton:!1,addTimestampForEdits:!1,timestampStyle:"R",useEphemeralForDeleted:!0},colors:{textColor:"#E40303",backgroundColor:"#FF2C2F",backgroundColorAlpha:"33",gutterColor:"#FF2C2F",gutterColorAlpha:"CC",semRawColorPrefix:"semanticColors.TEXT_BRAND"},inputs:{deletedMessageBuffer:"This message is deleted",editedMessageBuffer:"`[ EDITED ]`",historyToast:"[ANTI ED] History Removed",ignoredUserList:[],customPluginName:D.plugin?.manifest?.name||"ANTIED"},misc:{timestampPos:"BEFORE",editHistoryIcon:"ic_edit_24px"},debug:!1});let de={};const He=[];var _a={onLoad:function(){He.push(at(de),ot(de),rt(),it(),dt(),ut(),ft(de)),D.plugin?.manifest?.name!=r.storage?.inputs?.customPluginName&&(D.plugin.manifest.name=r.storage?.inputs?.customPluginName)},onUnload:function(){for(const a of He)a();D.plugin?.manifest?.name!=r.storage?.inputs?.customPluginName&&(D.plugin.manifest.name=r.storage?.inputs?.customPluginName);for(const a in ze._channelMessages)for(const s of ze._channelMessages[a]._array)s.was_deleted&&t.FluxDispatcher.dispatch({type:"MESSAGE_DELETE",id:s.id,channelId:s.channel_id,otherPluginBypass:!0})},settings:Pa};return x.default=_a,x.regexEscaper=W,x.stripVersions=ce,x.vendettaUiAssets=Ma,Object.defineProperty(x,"__esModule",{value:!0}),x})({},vendetta,vendetta.metro,vendetta.ui.components,vendetta.patcher,vendetta.ui.assets,vendetta.utils,vendetta.metro.common,vendetta.plugin,vendetta.ui.toasts,vendetta.storage,vendetta.ui,vendetta.ui.alerts);
