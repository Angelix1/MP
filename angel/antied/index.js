(function(_,$,f,h,x,m,Ge,t,s,H,I,R,Ye){"use strict";function je(a){var r=Object.create(null);return a&&Object.keys(a).forEach(function(e){if(e!=="default"){var o=Object.getOwnPropertyDescriptor(a,e);Object.defineProperty(r,e,o.get?o:{enumerable:!0,get:function(){return a[e]}})}}),r.default=a,Object.freeze(r)}var Xe=je(m);const{openLazy:We,hideActionSheet:xa}=f.findByProps("openLazy","hideActionSheet");function de(a,r){if(a!=null&&r!=null)for(const e of Object.keys(r))typeof r[e]=="object"&&!Array.isArray(r[e])?(typeof a[e]!="object"&&(a[e]={}),de(a[e],r[e])):a[e]??(a[e]=r[e])}function Je(a,r){try{We(new Promise(function(e){return e({default:a})}),"ActionSheet",r)}catch(e){$.logger.error(e.stack),showToast("Got error when opening ActionSheet! Please check debug logs")}}const Qe=function(a,r){return`${a}${Math.floor(r*255).toString(16).padStart(2,0)}`},W={toInt(a){return a=a.replace(/^#/,""),parseInt(a,16)},toHex(a){return"#"+a.toString(16).toUpperCase()},HSLtoHEX(a,r,e){e/=100;const o=r*Math.min(e,1-e)/100,n=function(l){const i=(l+a/30)%12,d=e-o*Math.max(Math.min(i-3,9-i,1),-1);return Math.round(255*d).toString(16).padStart(2,"0")};return`#${n(0)}${n(8)}${n(4)}`}};function ue(a){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return{version:a,new:r,updated:e,fix:o}}const qe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mJsrQAAAgwBAJ9P6qYAAAAASUVORK5CYII=",Ke={toPercentage:function(a){return a=Number(a),a===0?0:a===1?100:Math.round(a*100)},toDecimal:function(a){a=Number(a);const r=Math.min(Math.max(a,0),100);return r===0?0:r===100?1:r/100},formatDecimal:function(a){return a=Number(a),a===0||a===1?a:a.toFixed(2)},alphaToHex:function(a){a=Number(a);const r=Math.min(Math.max(a,0),100),e=Math.round(r/100*255).toString(16).toUpperCase();return e.length===1?"0"+e:e},hexAlphaToPercent:function(a){const r=parseInt(a,16);return isNaN(r)?0:Math.round(r/255*100)}};f.findByProps("openLazy","hideActionSheet");const ge=f.findByProps("getChannel","getDMFromUserId"),Ze=f.findByProps("_channelMessages"),et=f.findByProps("getMessage","getMessages");function tt(a){return x.before("dispatch",t.FluxDispatcher,function(r){const[e]=r,o=e?.type;if(s.storage.debug&&console.log("[ANTIED fluxdispatcher]",e),o=="MESSAGE_DELETE"){if(s.storage.switches.enableMD==!1||e?.otherPluginBypass)return r;const n=Ze.get(e.channelId)?.get(e.id);if(!n||e?.id&&a[e?.id]?.stage==2)return r;if(e?.id&&a[e?.id]?.stage==1)return a[e?.id].stage=2,a[e?.id]?.message??r;const l=n?.author?.id,i=n?.author?.username,d=!n?.content&&n?.attachments?.length==0&&n?.embeds?.length==0;if(!l||!i||d||s.storage?.switches?.ignoreBots&&n?.author?.bot||s.storage?.inputs?.ignoredUserList?.length>0&&s.storage.inputs.ignoredUserList?.some(function(g){return g?.id==n?.author?.id||g.username==n.author.username}))return r;const p=ge?.getChannel(n?.channel_id)?.guild_id;let c={...n,content:n?.content,type:0,channel_id:n?.channel_id||e?.channelId,guild_id:p,timestamp:`${new Date().toJSON()}`,state:"SENT",was_deleted:!0};return s.storage?.switches?.useEphemeralForDeleted&&(c.flags=64),r[0]={type:"MESSAGE_UPDATE",channelId:n?.channel_id||e?.channelId,message:c,optimistic:!1,sendMessageOptions:{},isPushNotification:!1},a[e?.id||n?.id]={message:r,stage:1},r}if(o=="MESSAGE_UPDATE"){if(s.storage.switches.enableMU==!1||e?.otherPluginBypass||e?.message?.author?.bot)return r;const n=et.getMessage(e?.message?.channel_id||e?.channelId,e?.message?.id||e?.id),l=n?.author?.id,i=n?.author?.username,d=!n?.content&&n?.attachments?.length==0&&n?.embeds?.length==0;if(!n||!l||!i||d||!e?.message?.content||!n?.content||e?.message?.content==n?.content||s.storage?.inputs?.ignoredUserList?.length>0&&s.storage?.inputs?.ignoredUserList?.some(function(w){return w?.id==n?.author?.id||w?.username==n?.author?.username}))return r;let p=s.storage?.inputs?.editedMessageBuffer||"`[ EDITED ]`";const c=function(w){return`${w}

`},g=e?.message||n;let b=`${n?.content}`;if(s.storage?.switches?.addTimestampForEdits){const w=Date.now(),A=["t","T","d","D","f","F","R"].some(function(E){return E==s.storage.switches.timestampStyle})?s.storage.switches.timestampStyle:"R",u=`<t:${Math.abs(Math.round(w/1e3))}:${A}>`;if(s.storage?.misc?.timestampPos=="BEFORE"){const E=`${c(`(${u}) ${p}`)}${e?.message?.content??""}`;b+=`  ${E}`}else{const E=`${c(`${p} (${u})`)}${e?.message?.content??""}`;b+=`  ${E}`}}else b+=`  ${c(p)}${e?.message?.content??""}`;const S=ge.getChannel(e?.channelId||e?.message?.channel_id||n?.channel_id)?.guild_id;return r[0]={type:"MESSAGE_UPDATE",message:{...g,content:b,guild_id:S,edited_timestamp:"invalid_timestamp"}},r}return r})}const at=f.findByProps("startEditMessage");function rt(){return x.before("startEditMessage",at,function(a){let r=s.storage?.inputs?.editedMessageBuffer||"`[ EDITED ]`";const e=X(r),o=new RegExp(`(?:(?:\\s${e}(\\s\\(<t:\\d+:[tTdDfFR]>\\))?\\n{2})|(?:(?:\\s\\(<t:\\d+:[tTdDfFR]>\\) ${e}\\n{2})))`,"gm"),[n,l,i]=a,d=i.split(o);return a[2]=d[d.length-1],a})}const{DCDChatManager:st}=t.ReactNative.NativeModules;function nt(a){return x.before("updateRows",st,function(r){let e=JSON.parse(r[1]);const{textColor:o,backgroundColor:n,backgroundColorAlpha:l,gutterColor:i,gutterColorAlpha:d}=s.storage.colors,p=s.storage.inputs?.deletedMessageBuffer,{useBackgroundColor:c,minimalistic:g,removeDismissButton:b}=s.storage.switches;function S(u,E){u||(u=E);const y=u?.trim();if(y.startsWith("#")){const D=y.slice(1);if(/^[0-9A-Fa-f]{6}$/.test(D))return"#"+D.toUpperCase()}else if(/^[0-9A-Fa-f]{6}$/.test(y))return"#"+y.toUpperCase();return E||"#000"}function w(u,E){const y=E?.toString(),D=["text","heading","s","u","em","strong","list","blockQuote"];if(Array.isArray(u))return u.map(function(T){return w(T,y)});if(typeof u=="object"&&u!==null){const{content:T,type:M,target:C,items:P}=u;if(!D.includes(M))return u;if(M==="text"&&T&&T.length>=1)return{content:[{content:T,type:"text"}],target:"usernameOnClick",type:"link",context:{username:1,medium:!0,usernameOnClick:{action:"0",userId:"0",linkColor:t.ReactNative.processColor(y),messageChannelId:"0"}}};const z=w(T,y),He=P?P.map(w,y):void 0;if(z!==T||He!==P||!D.includes(M)){const k={...u,content:z};return M==="blockQuote"&&C&&(k.content=z,k.target=C),M==="list"&&k?.content&&delete k.content,P&&(k.items=He),k}}return u}function A(u,E,y){return u&&u.content[0].content.splice(1),u}return e.forEach(function(u){if(s.storage.debug&&console.log(u),u?.type==1&&a[u?.message?.id]){if((p?.length>0||p!="")&&(u.message.edited=p),g==!1){const E=S(o,"#E40303"),y=w(u?.message?.content,E);u.message.content=y}if(b&&u?.message?.ephemeralIndication&&(u.message.ephemeralIndication=A(u.message.ephemeralIndication)),g==!1&&c==!0){const E=S(`${n}`,"#FF2C2F"),y=S(`${i}`,"#FF2C2F");u.backgroundHighlight??(u.backgroundHighlight={}),u.backgroundHighlight={backgroundColor:t.ReactNative.processColor(`${E}${l}`),gutterColor:t.ReactNative.processColor(`${y}${d}`)}}}}),r[1]=JSON.stringify(e),r[1]})}const ot=f.findByProps("updateMessageRecord","createMessageRecord");function lt(){return x.after("createMessageRecord",ot,function(a,r){let[e]=a;r.was_deleted=e.was_deleted})}const it=f.findByName("MessageRecord",!1);function ct(){return x.after("default",it,function(a,r){let[e]=a;r.was_deleted=!!e.was_deleted})}const me=f.findByProps("updateMessageRecord","createMessageRecord");function dt(){return x.instead("updateMessageRecord",me,function(a,r){let[e,o]=a;return o.was_deleted?me.createMessageRecord(o,e.reactions):r.apply(this,[e,o])})}const J=f.findByProps("openLazy","hideActionSheet"),ut=f.findByProps("getMessage","getMessages"),fe=f.findByProps("getChannel","getDMFromUserId"),{ActionSheetRow:G}=f.findByProps("ActionSheetRow");function gt(a){return x.before("openLazy",J,function(r){let[e,o,n]=r;const l=n?.message;o!=="MessageLongPressActionSheet"||!l||e.then(function(i){const d=x.after("default",i,function(p,c){t.React.useEffect(function(){return function(){d()}},[]),s.storage.debug&&console.log("[ANTIED ActionSheet]",l);const g=Ge.findInReactTree(c,function(A){return A?.find?.(function(u){return u?.props?.label==t.i18n?.Messages?.MESSAGE_ACTION_REPLY})});if(!g)return c;const b=Math.max(g.findIndex(function(A){return A?.props?.label==t.i18n?.Messages?.MESSAGE_ACTION_REPLY}),g.length-1),S=ut.getMessage(l.channel_id,l?.id),w=X(s.storage?.inputs?.editedMessageBuffer||"`[ EDITED ]`");if(new RegExp(w,"gmi").test(l.content)){const A=b||1;g.splice(A,0,t.React.createElement(G,{label:"Remove Edit History",subLabel:`Added by ${ie($.plugin?.manifest?.name)||"ANTIED"}`,icon:t.React.createElement(G.Icon,{source:m.getAssetIDByName("ic_edit_24px")}),onPress:function(){let u=s.storage?.inputs?.editedMessageBuffer||"`[ EDITED ]`";const E=X(u),y=new RegExp(`(?:(?:\\s${E}(\\s\\(<t:\\d+:[tTdDfFR]>\\))?\\n{2})|(?:(?:\\s\\(<t:\\d+:[tTdDfFR]>\\) ${E}\\n{2})))`,"gm"),D=l?.content?.split(y);s.storage.debug&&console.log([[u],l?.content?.split(y),D]);const T=D[D.length-1],M=l?.embeds?.map(function(C){const P=C?.color?.replace(/.+\(/,"")?.replace(/%/g,"")?.replace(")","")?.split(", "),z=t.ReactNative.processColor(`${Qe(W.HSLtoHEX(P[0],P[1],P[2]),P[3])}`);return{...C,author:C.author,title:C.rawTitle,description:C.rawDescription,url:C.url,type:C.type,image:C.image,thumbnail:C.thumbnail,color:z,content_scan_version:1}});t.FluxDispatcher.dispatch({type:"MESSAGE_UPDATE",message:{...l,content:`${T}`,embeds:M??[],attachments:l.attachments??[],mentions:l.mentions??[],guild_id:fe.getChannel(S.channel_id).guild_id},otherPluginBypass:!0}),J.hideActionSheet(),(s.storage?.inputs?.historyToast?.length>0||s.storage?.inputs?.historyToast!="")&&H.showToast(s.storage?.inputs?.historyToast?.toString?.(),m.getAssetIDByName(s.storage?.misc?.editHistoryIcon||"ic_edit_24px"))}}))}if(s.storage.debug&&console.log("[ANTIED ActionSheet]","useEphemeralForDeleted",!s.storage?.switches?.useEphemeralForDeleted,"msgExist?",!!a[l.id]),!s.storage?.switches?.useEphemeralForDeleted&&a[l.id]){const A=b||1;g.splice(A,0,t.React.createElement(G,{label:"Remove Deleted Message",subLabel:`Added by ${ie($.plugin?.manifest?.name)||"ANTIED"}`,isDestructive:!0,icon:t.React.createElement(G.Icon,{source:m.getAssetIDByName("ic_edit_24px")}),onPress:function(){t.FluxDispatcher.dispatch({type:"MESSAGE_DELETE",guildId:fe.getChannel(S.channel_id).guild_id,id:l?.id,channelId:l?.channel_id,otherPluginBypass:!0}),J.hideActionSheet(),(s.storage?.inputs?.historyToast?.length>0||s.storage?.inputs?.historyToast!="")&&H.showToast("[ANTIED] Message Removed",m.getAssetIDByName("ic_edit_24px"))}}))}})})})}const{ScrollView:La,View:mt,Text:Ma,TouchableOpacity:_a,TextInput:Ba,Pressable:Na,Image:va,Animated:ka}=h.General,{FormLabel:Ua,FormIcon:ft,FormArrow:Oa,FormRow:ht,FormSwitch:Rt,FormSwitchRow:Va,FormSection:za,FormDivider:bt,FormInput:Ha,FormSliderRow:Ga}=h.Forms,he=[{id:"enableMD",default:!0,label:"Toggle Message Delete",subLabel:"Logs deleted message"},{id:"enableMU",default:!0,label:"Toggle Message Update",subLabel:"Logs edited message"}];function pt(a){let{styles:r}=a;return I.useProxy(s.storage),React.createElement(React.Fragment,null,React.createElement(mt,{style:[r.subText]},he?.map(function(e,o){return React.createElement(React.Fragment,null,React.createElement(ht,{label:e?.label,subLabel:e?.subLabel,leading:e?.icon&&React.createElement(ft,{style:{opacity:1},source:m.getAssetIDByName(e?.icon)}),trailing:"id"in e?React.createElement(Rt,{value:s.storage?.switches[e?.id]??e?.default,onValueChange:function(n){return s.storage.switches[e?.id]=n}}):void 0}),o!==he?.length-1&&React.createElement(bt,null))})))}const{ScrollView:Ya,View:Et,Text:ja,TouchableOpacity:Xa,TextInput:Wa,Pressable:Ja,Image:Qa,Animated:qa}=h.General,{FormLabel:Ka,FormIcon:yt,FormArrow:Za,FormRow:wt,FormSwitch:er,FormSwitchRow:tr,FormSection:ar,FormDivider:Q,FormInput:q,FormSliderRow:rr}=h.Forms,Re=[{id:"deletedMessageBuffer",title:"Customize Deleted Message",type:"default",placeholder:"This message is deleted"},{id:"editedMessageBuffer",title:"Customize Edited Separator",type:"default",placeholder:"`[ EDITED ]`"},{id:"historyToast",title:"Customize Remove History Toast Message",type:"default",placeholder:"History Removed"}];function Ft(a){let{styles:r}=a;return I.useProxy(s.storage),React.createElement(React.Fragment,null,React.createElement(Et,{style:[r.subText]},Re?.map(function(e,o){return React.createElement(React.Fragment,null,React.createElement(q,{title:e?.title,keyboardType:e?.type,placeholder:e?.placeholder?.toString(),value:s.storage?.inputs[e.id]??e?.placeholder,onChange:function(n){return s.storage.inputs[e.id]=n.toString()}}),o!==Re.length-1&&React.createElement(Q,null))}),React.createElement(q,{title:"Customize Plugin Name",keyboardType:"default",placeholder:s.storage?.inputs?.customPluginName||$.plugin?.manifest?.name||"ANTIED",value:s.storage?.inputs?.customPluginName,onChange:function(e){s.storage.inputs.customPluginName=e.toString(),$.plugin.manifest.name=e.toString()}}),React.createElement(Q,null),React.createElement(wt,{label:`Current Used Icon - ${s.storage?.misc?.editHistoryIcon||"ic_edit_24px"}`,subLabel:"Icon for Message History Removed toast",trailing:React.createElement(yt,{style:{opacity:1},source:m.getAssetIDByName(s.storage?.misc?.editHistoryIcon)})}),React.createElement(Q,null),React.createElement(q,{title:"Icon Name",keyboardType:"default",placeholder:"ic_edit_24px",value:s.storage?.misc?.editHistoryIcon||"ic_edit_24px",onChange:function(e){return s.storage.misc.editHistoryIcon=e.toString()}})))}const{FormRow:Ct}=h.Forms,St=f.findByName("RowCheckmark");function K(a){let{label:r,subLabel:e,selected:o,onPress:n}=a;return React.createElement(Ct,{label:r,subLabel:e,trailing:React.createElement(St,{selected:o}),onPress:n})}const be=[{type:"t",label:"Short Time",subLabel:"16:20"},{type:"T",label:"Long Time",subLabel:"16:20:30"},{type:"d",label:"Short Date",subLabel:"20/04/2021"},{type:"D",label:"Long Date",subLabel:"20 April 2021"},{type:"f",label:"Short Date/Time",subLabel:"20 April 2021 16:20"},{type:"F",label:"Long Date/Time",subLabel:"Tuesday, 20 April 2021 16:20"},{type:"R",label:"Relative Time",subLabel:"2 months ago"}],pe=[{label:"Before",subLabel:"Old Message (2 minutes ago) [Edited] New Message",key:"BEFORE"},{label:"After",subLabel:"Old Message [Edited] (2 minutes ago) New Message",key:"AFTER"}],{FormRow:Ee,FormDivider:Z}=h.Forms;function At(){return I.useProxy(s.storage),React.createElement(React.Fragment,null,React.createElement(Ee,{label:"Timestamp Style"}),be.map(function(a,r){let{type:e,label:o,subLabel:n}=a;return React.createElement(React.Fragment,null,React.createElement(K,{label:o,subLabel:`Example: ${n}`,selected:s.storage.switches.timestampStyle==e,onPress:function(){return s.storage.switches.timestampStyle=e}}),r!==be.length-1&&React.createElement(Z,null))}),React.createElement(Z,null),React.createElement(Ee,{label:"Timestamp Position"}),pe.map(function(a,r){let{key:e,label:o,subLabel:n}=a;return React.createElement(React.Fragment,null,React.createElement(K,{label:o,subLabel:`Example: ${n}`,selected:s.storage.misc?.timestampPos==e,onPress:function(){return s.storage.misc.timestampPos=e}}),r!==pe.length-1&&React.createElement(Z,null))}))}const $t=Object.keys(R.semanticColors).map(function(a){return`semanticColors.${a}`}),It=Object.keys(R.rawColors).map(function(a){return`rawColors.${a}`}),ye=[...$t,...It],{FormRow:Dt,FormDivider:Tt,ScrollView:Pt}=h.Forms;function xt(){return I.useProxy(s.storage),React.createElement(React.Fragment,null,React.createElement(Pt,null,React.createElement(Dt,{label:"Choose Color"}),ye.map(function(a,r){return React.createElement(React.Fragment,null,React.createElement(K,{label:a,selected:s.storage.colors.semRawColorPrefix==a,onPress:function(){return s.storage.colors.semRawColorPrefix=a}}),r!==ye.length-1&&React.createElement(Tt,null))})))}const Lt=f.findByName("CustomColorPickerActionSheet"),{alphaToHex:ee,hexAlphaToPercent:we,toPercentage:U,toDecimal:Fe,formatDecimal:Ce}=Ke,{ScrollView:sr,View:O,Text:Se,TouchableOpacity:Mt,TextInput:nr,Pressable:or,Image:_t,Animated:lr}=h.General,{FormLabel:ir,FormIcon:cr,FormArrow:dr,FormRow:V,FormSwitch:Bt,FormSwitchRow:ur,FormSection:gr,FormDivider:Nt,FormInput:mr,FormSliderRow:Ae}=h.Forms,$e=[{id:"textColor",label:"Deleted Message Text Color",subLabel:"Click to customize Deleted Message Text Color",defaultColor:"#E40303"},{id:"backgroundColor",label:"Deleted Message Background Color",subLabel:"Click to customize Background Color",defaultColor:"#FF2C2F"},{id:"gutterColor",label:"Deleted Message Background Gutter Color",subLabel:"Click to customize Background Gutter Color",defaultColor:"#FF2C2F"}];function vt(a){let{styles:r}=a;I.useProxy(s.storage);const[e,o]=t.React.useState(Fe(we(s.storage?.colors?.backgroundColorAlpha)??100)),[n,l]=t.React.useState(Fe(we(s.storage?.colors?.gutterColorAlpha)??100)),i=t.NavigationNative.useNavigation(),d=function(c){return ee(U(c))},p=function(c){if(!c)return null;const[g,b]=c.split(".");return g=="semanticColors"?R.semanticColors[b]:R.rawColors[b]};return t.React.createElement(t.React.Fragment,null,t.React.createElement(O,{style:[r.subText]},s.storage?.switches?.useSemRawColors&&t.React.createElement(t.React.Fragment,null,t.React.createElement(V,{label:"Semantic & Raw Colors",subLabel:"If you enabled [Use Semantic/Raw Color], you can pick the colors from here",leading:t.React.createElement(V.Icon,{source:m.getAssetIDByName("ic_audit_log_24px")}),trailing:V.Arrow,onPress:function(){return i.push("VendettaCustomPage",{title:"Semantic & Raw Colors",render:function(){return t.React.createElement(xt,null)}})}})),$e?.map(function(c){const g=function(){return Je(Lt,{color:W?.toInt(s.storage.colors[c.id]||c?.defaultColor||"#000"),onSelect:function(b){const S=W?.toHex(b);s.storage.colors[c.id]=S}})};return t.React.createElement(t.React.Fragment,null,t.React.createElement(V,{label:c?.label,subLabel:c?.subLabel||"Click to Update",onPress:g,trailing:t.React.createElement(Mt,{onPress:g},t.React.createElement(_t,{source:{uri:qe},style:{width:32,height:32,borderRadius:10,backgroundColor:s.storage?.colors[c.id]||$e.find(function(b){return b?.id==c?.id})?.defaultColor||"#000"}}))}))}),t.React.createElement(O,{style:r.container},t.React.createElement(V,{style:{justifyContent:"center",alignItems:"center"},label:`Preview Style: ${s.storage?.switches?.darkMode?"Dark":"Light"} Mode`,subLabel:"Click to Switch Mode",trailing:t.React.createElement(Bt,{value:s.storage?.switches?.darkMode??!0,onValueChange:function(c){return s.storage.switches.darkMode=c}})}),t.React.createElement(O,{style:[r.row,r.border,{overflow:"hidden",marginRight:10}]},t.React.createElement(O,{style:{width:"2%",backgroundColor:`${s.storage.colors.gutterColor}${d(n)}`}}),t.React.createElement(O,{style:{flex:1,backgroundColor:`${s.storage.switches.useSemRawColors&&p(s.storage?.colors?.semRawColorPrefix)||s.storage.colors.backgroundColor}${d(e)}`,justifyContent:"center",alignItems:"center"}},t.React.createElement(Se,{style:{fontSize:20,color:s.storage?.switches?.darkMode?"white":"black"}}," Low Effort Normal Example Message "),t.React.createElement(Se,{style:{fontSize:20,color:s.storage.colors.textColor||"#000000"}}," Low Effort Deleted Example Message "))),t.React.createElement(Ae,{label:`Background Color Alpha: ${U(e)}%`,value:e,style:{width:"90%"},onValueChange:function(c){o(Number(Ce(c))),s.storage.colors.backgroundColorAlpha=ee(U(c))}}),t.React.createElement(Nt,null),t.React.createElement(Ae,{label:`Background Gutter Alpha: ${U(n)}%`,value:n,style:{width:"90%"},onValueChange:function(c){l(Number(Ce(c))),s.storage.colors.gutterColorAlpha=ee(U(c))}}))))}const{ScrollView:kt,View:te,Text:Ut,TouchableOpacity:Ie,TextInput:fr,Image:Ot,Animated:Y}=h.General,{FormLabel:Vt,FormIcon:zt,FormArrow:hr,FormRow:ae,FormSwitch:Ht,FormSwitchRow:Rr,FormSection:Gt,FormDivider:Yt,FormInput:De}=h.Forms,jt=f.findByName("useIsFocused");f.findByProps("BottomSheetScrollView");const Te=f.findByStoreName("UserStore"),Pe=f.findByProps("showUserProfile");m.getAssetIDByName("ic_add_24px"),m.getAssetIDByName("ic_arrow"),m.getAssetIDByName("ic_minus_circle_24px"),m.getAssetIDByName("Check"),m.getAssetIDByName("Small");function xe(a){return t.React.createElement(zt,{style:{opacity:1},source:m.getAssetIDByName(a)})}const L=t.stylesheet.createThemedStyleSheet({basicPad:{paddingRight:10,marginBottom:10,letterSpacing:.25},header:{color:R.semanticColors.HEADER_PRIMARY,fontFamily:t.constants.Fonts.DISPLAY_BOLD,fontSize:25,paddingLeft:"3%",letterSpacing:.25},sub:{color:R.semanticColors.TEXT_POSITIVE,fontFamily:t.constants.Fonts.DISPLAY_NORMAL,paddingLeft:"4%",fontSize:18},flagsText:{color:R.semanticColors.HEADER_SECONDARY,fontFamily:t.constants.Fonts.PRIMARY_BOLD,paddingLeft:"4%",fontSize:16},container:{marginTop:25,marginLeft:"5%",marginBottom:-15,flexDirection:"row"},textContainer:{paddingLeft:15,paddingTop:5,flexDirection:"column",flexWrap:"wrap",shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:.2,shadowRadius:4.65,elevation:8},image:{width:75,height:75,borderRadius:10,shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:.2,shadowRadius:4.65,elevation:8},mainText:{opacity:.975,letterSpacing:.25},subHeader:{color:R.semanticColors.HEADER_SECONDARY,fontSize:12.75}});function Le(a){let{index:r}=a;I.useProxy(s.storage);let e=s.storage?.inputs?.ignoredUserList[r];const o=t.React.useRef(new Y.Value(1)).current,n=function(){return Y.spring(o,{toValue:1.1,duration:10,useNativeDriver:!0}).start()},l=function(){return Y.spring(o,{toValue:1,duration:250,useNativeDriver:!0}).start()},i={transform:[{scale:o}]};let d=Te.getUser(e?.id),p=Object.values(Te.getUsers());d||(d=p.find(function(g){return g?.username==e?.username})),d||(d=p.find(function(g){return g?.username?.toLowerCase()==e?.username?.toLowerCase()}));const c=t.NavigationNative.useNavigation();return jt(),t.React.createElement(t.React.Fragment,null,t.React.createElement(kt,null,t.React.createElement(te,{style:[L.basicPad,L.sub]},t.React.createElement(Gt,{title:"User Setting",style:[L.header]},t.React.createElement(ae,{label:"Find User Id or Username",leading:xe("ic_search"),onPress:function(){d&&!e.username?.length?e.username=d.username:d&&!e.id?.length?e.id=d.id:H.showToast("Cannot find User Id/Username.")}}),t.React.createElement(De,{title:"User Username | Case Sensitive",placeholder:"Missing No",value:e?.username,onChange:function(g){return e.username=g}}),t.React.createElement(De,{title:"User Id",placeholder:"Missing No",value:e?.id,onChange:function(g){return e.id=g}}),t.React.createElement(ae,{label:"User is webhook?",subLabel:"User is webhook or system, and not BOT or Normal User.",leading:xe("ic_webhook_24px"),trailing:t.React.createElement(Ht,{value:e?.isWebhook||!1,onValueChange:function(g){return e.isWebhook=g}})})),d&&t.React.createElement(te,{style:[L.container,{paddingBottom:10}]},t.React.createElement(Ie,{onPress:function(){return Pe.showUserProfile?.({userId:d?.id})},onPressIn:n,onPressOut:l},t.React.createElement(Y.View,{style:i},t.React.createElement(Ot,{source:{uri:d?.getAvatarURL?.()?.replace?.("webp","png")||"https://cdn.discordapp.com/embed/avatars/2.png"},style:{width:128,height:128,borderRadius:10}}))),t.React.createElement(te,{style:L.textContainer},t.React.createElement(Ie,{onPress:function(){return Pe.showUserProfile({userId:d?.id})}},t.React.createElement(Ut,{style:[L.mainText,L.header]},d?.username||e?.username||"No Name"))),t.React.createElement(Yt,null)),t.React.createElement(ae,{label:t.React.createElement(Vt,{text:"Remove User from Ignore List",style:{color:R.rawColors.RED_400}}),onPress:function(){c.pop(),s.storage?.inputs?.ignoredUserList?.splice(r,1)}}))))}const{ScrollView:Xt,View:Wt,Text:br,TouchableOpacity:Jt,TextInput:Qt}=h.General,{FormLabel:pr,FormIcon:qt,FormArrow:Kt,FormRow:re,FormSwitch:Er,FormSwitchRow:yr,FormSection:Zt,FormDivider:ea,FormInput:wr}=h.Forms;function Me(a,r){return t.React.createElement(qt,{style:{opacity:1},source:a})}const ta=f.findByName("useIsFocused");f.findByProps("BottomSheetScrollView");const{getUser:aa}=f.findByProps("getUser"),ra=m.getAssetIDByName("ic_add_24px");m.getAssetIDByName("ic_arrow"),m.getAssetIDByName("ic_minus_circle_24px"),m.getAssetIDByName("Check"),m.getAssetIDByName("Small");const sa=m.getAssetIDByName("ic_trash_24px"),B=t.stylesheet.createThemedStyleSheet({basicPad:{paddingRight:10,marginBottom:10,letterSpacing:.25},header:{color:R.semanticColors.HEADER_SECONDARY,fontFamily:t.constants.Fonts.PRIMARY_BOLD,paddingLeft:"3.5%",fontSize:24},sub:{color:R.semanticColors.TEXT_POSITIVE,fontFamily:t.constants.Fonts.DISPLAY_NORMAL,paddingLeft:"4%",fontSize:18},flagsText:{color:R.semanticColors.HEADER_SECONDARY,fontFamily:t.constants.Fonts.PRIMARY_BOLD,paddingLeft:"4%",fontSize:16},input:{fontSize:16,fontFamily:t.constants.Fonts.PRIMARY_MEDIUM,color:R.semanticColors.TEXT_NORMAL},placeholder:{color:R.semanticColors.INPUT_PLACEHOLDER_TEXT}});function na(){I.useProxy(s.storage);let[a,r]=t.React.useState("");const e=t.NavigationNative.useNavigation();ta();let o=s.storage?.inputs?.ignoredUserList??[];const n=function(){if(a){if(isNaN(parseInt(a)))o.push({id:void 0,username:a});else{let l=aa(a);if(l)o.push({id:l?.id,username:"",showUser:!1,isWebhook:!1});else return H.showToast("Invalid User Id")}r(""),e.push("VendettaCustomPage",{title:"Adding User to Ignore List",render:function(){return t.React.createElement(Le,{index:o?.length-1})}})}};return t.React.createElement(t.React.Fragment,null,t.React.createElement(Xt,{style:{flex:1}},t.React.createElement(Zt,{style:[B.header,B.basicPad]},t.React.createElement(Wt,{style:[B.header,B.sub]},o.length>0&&t.React.createElement(re,{label:"Clear List",trailing:Me(sa),onPress:function(){o.length!==0&&Ye.showConfirmationAlert({title:"Hol up, wait a minute!",content:`This will removes in total ${o.length} users from ignore list.`,confirmText:"Ye",cancelText:"Nah",confirmColor:"brand",onConfirm:function(){s.storage.inputs.ignoredUserList=[]}})}}),o?.map(function(l,i){return t.React.createElement(t.React.Fragment,null,t.React.createElement(re,{label:l?.username||l?.id||"No Data",trailing:t.React.createElement(Kt,null),onPress:function(){return e.push("VendettaCustomPage",{title:"Editing User",render:function(){return t.React.createElement(Le,{index:i})}})}}),i!==o?.length-1&&t.React.createElement(ea,null))}),t.React.createElement(re,{label:t.React.createElement(Qt,{value:a,onChangeText:r,placeholder:"User ID or Username",placeholderTextColor:B.placeholder.color,selectionColor:t.constants.Colors.PRIMARY_DARK_100,onSubmitEditing:n,returnKeyType:"done",style:B.input}),trailing:t.React.createElement(Jt,{onPress:n},Me(ra))})))))}const{ScrollView:Fr,View:Cr,Text:Sr,TouchableOpacity:oa,TextInput:Ar,Pressable:$r,Image:Ir,Animated:Dr}=h.General,{FormLabel:Tr,FormIcon:_e,FormArrow:Pr,FormRow:la,FormSwitch:xr,FormSwitchRow:Lr,FormSection:Mr,FormDivider:ia,FormInput:_r,FormSliderRow:Br}=h.Forms;function ca(){I.useProxy(s.storage);const a=t.NavigationNative.useNavigation(),r=function(){a.push("VendettaCustomPage",{title:"List of Ignored Users",render:function(){return React.createElement(na,null)}})};return React.createElement(React.Fragment,null,React.createElement(la,{label:"Add User to List",subLabel:"List of ignored users for the plugin",leading:React.createElement(_e,{style:{opacity:1},source:m.getAssetIDByName("ic_members")}),onPress:r,trailing:React.createElement(oa,{onPress:r},React.createElement(_e,{style:{opacity:1},source:m.getAssetIDByName("ic_add_24px")}))}),React.createElement(ia,null))}const{ScrollView:Nr,View:da,Text:vr,TouchableOpacity:kr,TextInput:Ur,Pressable:Or,Image:Vr,Animated:zr}=h.General,{FormRow:ua,FormIcon:ga,FormSwitch:ma,FormDivider:fa}=h.Forms,ha=f.findByName("HelpMessage"),Be=[{id:"minimalistic",default:!0,label:"Minimalistic Settings",subLabel:"Removes all Styling (Enabled by Default)"},{id:"useBackgroundColor",default:!1,label:"Enable Background Color",subLabel:"Background Color for Deleted Message, similiar to Mention but Customizeable"},{id:"useSemRawColors",default:!1,label:"Use Semantic/Raw Color",subLabel:"Use Semantic/Raw Color instead of Custom Color for Background Color, doesn't applied to GutterColor"},{id:"ignoreBots",default:!1,label:"Ignore Bots",subLabel:"Ignore bot deleted messages."},{id:"removeDismissButton",default:!1,label:"Remove Dissmiss Message",subLabel:"Remove clickable Dismiss Message text from deleted ephemeral messages."},{id:"addTimestampForEdits",default:!1,label:"Add Edit Timestamp",subLabel:"Add Timestamp for edited messages."},{id:"useEphemeralForDeleted",default:!0,label:"Use Ephemeral for Deleted",subLabel:"When messages got deleted it'll use ephemeral instead of normal message (Enabled by Default)."}];function Ra(a){let{styles:r}=a;return I.useProxy(s.storage),React.createElement(React.Fragment,null,React.createElement(da,{style:[r.subText]},s.storage?.switches.minimalistic&&React.createElement(ha,{messageType:0},'To use styling, disable "Minimalistic" option'),Be?.map(function(e,o){return React.createElement(React.Fragment,null,React.createElement(ua,{label:e?.label,subLabel:e?.subLabel,leading:e?.icon&&React.createElement(ga,{style:{opacity:1},source:m.getAssetIDByName(e?.icon)}),trailing:"id"in e?React.createElement(ma,{value:s.storage?.switches[e?.id]??e?.default,onValueChange:function(n){return s.storage.switches[e?.id]=n}}):void 0}),o!==Be?.length-1&&React.createElement(fa,null))})))}function N(){for(var a=arguments.length,r=new Array(a),e=0;e<a;e++)r[e]=arguments[e];return[...r]}var se=[ue("1.2.0 - 1.2.5",N("[1.2.0] Added Update Section","[1.2.2] Added Support for Semantic Colors","[1.2.2] Added Support for Raw Colors","[1.2.2] Added Support for Timestamp Format","[1.2.5] Added option useEphemeralForDeleted modification in Customize Section","[1.2.5] Added new button on actionMessage if useEphemeralForDeleted disabled"),N("[1.2.1] Redesign Setting Page","[1.2.2] Reworked how Message update appends separator","[1.2.4] Update Remove Edit button style"),N("[1.2.3] Fixed Remove Edit button to not persist under Edit Message Button","[1.2.4] Fixed Message Parser Fails to parse edited message")),ue("1.3",N("[1.3] Option to custom name the plugin","[1.3] Option to replace icon toast for edited history toast"),N("[1.3] Removes Logging system due crashes and inefficient code","[1.3] Removes patch to user setting to avoid crashes again"),N("[1.3] Hopefully fixed the issue with IOS crash on setting"))].reverse();const{ScrollView:Gr,View:Ne,Text:Yr,TouchableOpacity:jr,TextInput:Xr,Image:Wr,Animated:Jr}=h.General,{FormLabel:Qr,FormIcon:ba,FormArrow:qr,FormRow:ne,FormSwitch:Kr,FormSwitchRow:Zr,FormSection:es,FormDivider:pa,FormInput:ts}=h.Forms,Ea=m.getAssetIDByName("ic_radio_square_checked_24px"),ya=m.getAssetIDByName("ic_radio_square_24px"),wa=m.getAssetIDByName("ic_information_24px");m.getAssetIDByName("ic_info");const Fa=m.getAssetIDByName("premium_sparkles"),Ca=m.getAssetIDByName("ic_sync_24px"),Sa=m.getAssetIDByName("ic_progress_wrench_24px"),v=t.stylesheet.createThemedStyleSheet({border:{borderRadius:10},textBody:{color:R.semanticColors.TEXT_NORMAL,fontFamily:t.constants.Fonts.PRIMARY_MEDIUM,letterSpacing:.25,fontSize:22},textBody:{color:R.semanticColors.INPUT_PLACEHOLDER_TEXT,fontFamily:t.constants.Fonts.DISPLAY_NORMAL,letterSpacing:.25,fontSize:16},versionBG:{margin:10,padding:15,backgroundColor:"rgba(55, 149, 225, 0.3)"},rowLabel:{margin:10,padding:15,backgroundColor:"rgba(33, 219, 222, 0.34)"}});function j(a){return t.React.createElement(ba,{style:{opacity:1},source:a})}function Aa(a){let{change:r,index:e,totalIndex:o}=a;const[n,l]=t.React.useState(!1);t.React.useState(!1);function i(d,p,c,g){return t.React.createElement(Ne,null,t.React.createElement(ne,{label:p||"No Section",subLabel:c||null,leading:g&&j(g),style:[v.textHeader]}),d.map(function(b,S){return t.React.createElement(t.React.Fragment,null,t.React.createElement(ne,{label:b,style:[v.textBody,v.rowLabel,v.border]}))}))}return t.React.createElement(t.React.Fragment,null,t.React.createElement(h.ErrorBoundary,null,t.React.createElement(ne,{label:r?.version,leading:e==0?j(Ea):j(ya),trailing:j(wa),onPress:function(){l(!n)}}),n&&t.React.createElement(Ne,{style:[v.versionBG,v.border]},r?.new?.length>0&&i(r.new,"New","New stuffies",Fa),r?.updated?.length>0&&i(r.updated,"Changes","Update things",Ca),r?.fix?.length>0&&i(r.fix,"Fixes","Me hate borken things",Sa)),e==o.length-1?void 0:t.React.createElement(pa,null)))}const{ScrollView:$a,View:oe,Text:as,TouchableOpacity:rs,TextInput:ss,Pressable:ns,Image:os,Animated:le}=h.General,{FormLabel:ls,FormIcon:is,FormArrow:cs,FormRow:ve,FormSwitch:ke,FormSwitchRow:ds,FormSection:Ue,FormDivider:Oe,FormInput:us,FormSliderRow:gs}=h.Forms,Ia=f.findByName("LinearGradient"),F=t.stylesheet.createThemedStyleSheet({text:{color:R.semanticColors.HEADER_SECONDARY,paddingLeft:"5.5%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:t.constants.Fonts.PRIMARY_BOLD,fontSize:16},subText:{color:R.semanticColors.TEXT_POSITIVE,paddingLeft:"6%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:t.constants.Fonts.DISPLAY_NORMAL,fontSize:12},input:{fontSize:16,fontFamily:t.constants.Fonts.PRIMARY_MEDIUM,color:R.semanticColors.TEXT_NORMAL},placeholder:{color:R.semanticColors.INPUT_PLACEHOLDER_TEXT},container:{flex:1,justifyContent:"center",alignItems:"center"},colorPreview:{width:"75%",height:100,marginBottom:20},row:{flexDirection:"row",height:80,width:"90%",marginBottom:20},border:{borderRadius:12},lnBorder:{borderRadius:12,overflow:"hidden"},shadowTemplate:{shadowOffset:{width:1,height:3},shadowOpacity:.9,shadowRadius:24,elevation:16},lnShadow:{flex:1,margin:"1%",shadowColor:"#b8ff34"},darkMask:{backgroundColor:"rgba(10, 10, 10, 0.9)",margin:2,padding:"3%"},padBot:{paddingBottom:20}});function Da(){I.useProxy(s.storage);const[a]=t.React.useState(new le.Value(0));t.React.useEffect(function(){le.loop(le.timing(a,{toValue:4,duration:8e3,useNativeDriver:!0})).start()},[]);const r={backgroundColor:a.interpolate({inputRange:[0,1,2,3,4],outputRange:["rgba(188,31,31,0.5)","rgba(46,168,30,0.5)","rgba(48,179,173,0.5)","rgba(183,40,198,0.5)","rgba(188,31,31,0.5)"]})},e=function(i,d,p,c,g,b){return{id:i,title:d,label:p,subLabel:c,props:g,propsData:b}},o=[e("patches","Plugin Patcher","Show Patches","Toggle what the plugin patch",pt,F),e("customize","Customization","Customize",null,Ra,F),e("text","Text Variables","Customize Texts",null,Ft,F),e("timestamp","Timestamp","Timestamp Styles",null,At,F),e("colorpick","Colors","Customize Colors",null,vt,F),e("ingorelist","Ignore List","Show IngoreList",null,ca,null)],n=t.ReactNative?.Platform?.OS||null,l=t.React.createElement(t.React.Fragment,null,t.React.createElement(oe,{style:[F.lnBorder,r,F.darkMask]},o.map(function(i){return t.React.createElement(t.React.Fragment,null,t.React.createElement(Ue,{title:i?.title},t.React.createElement(ve,{label:i?.label,subLabel:i?.subLabel,trailing:t.React.createElement(ke,{value:s.storage.setting[i?.id],onValueChange:function(d){s.storage.setting[i?.id]=d}})}),s.storage.setting[i.id]&&i.props&&t.React.createElement(oe,{style:{margin:5,padding:10,borderRadius:10,backgroundColor:"rgba(0, 0, 0, 0.15)"}},t.React.createElement(i.props,{styles:i.propsData}))))}),t.React.createElement(Oe,null),t.React.createElement(ve,{label:"Debug",subLabel:"Enable console logging",style:[F.padBot],trailing:t.React.createElement(ke,{value:s.storage.debug,onValueChange:function(i){s.storage.debug=i}})}),t.React.createElement(Oe,null),se&&t.React.createElement(Ue,{title:"Updates"},t.React.createElement(oe,{style:{margin:5,padding:5,borderRadius:10,backgroundColor:"rgba(59, 30, 55, 0.15)"}},se.map(function(i,d){return t.React.createElement(Aa,{change:i,index:d,totalIndex:se.length})})))));return t.React.createElement(t.React.Fragment,null,t.React.createElement($a,null,n=="android"?t.React.createElement(t.React.Fragment,null,t.React.createElement(Ia,{start:{x:.8,y:0},end:{x:0,y:.8},colors:["#b8ff34","#4bff61","#44f6ff","#4dafff","#413dff","#d63efd"],style:[F.lnBorder,F.shadowTemplate,F.lnShadow,F.padBot]},l)):l))}const Ve=f.findByProps("_channelMessages"),X=function(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},ie=function(a){return a.replace(/\s?v\d+.\d+.\w+/,"")},Ta=Object.keys(Xe.all).map(function(a){return a?.name});de(s.storage,{setting:{colorpick:!1,customize:!1,ingorelist:!1,patches:!1,text:!1,timestamp:!1},switches:{customizeable:!1,enableMD:!0,enableMU:!0,useBackgroundColor:!1,useSemRawColors:!1,ignoreBots:!1,minimalistic:!0,alwaysAdd:!1,darkMode:!0,removeDismissButton:!1,addTimestampForEdits:!1,timestampStyle:"R",useEphemeralForDeleted:!0},colors:{textColor:"#E40303",backgroundColor:"#FF2C2F",backgroundColorAlpha:"33",gutterColor:"#FF2C2F",gutterColorAlpha:"CC",semRawColorPrefix:"semanticColors.TEXT_BRAND"},inputs:{deletedMessageBuffer:"This message is deleted",editedMessageBuffer:"`[ EDITED ]`",historyToast:"[ANTI ED] History Removed",ignoredUserList:[],customPluginName:$.plugin?.manifest?.name||"ANTIED"},misc:{timestampPos:"BEFORE",editHistoryIcon:"ic_edit_24px"},debug:!1});let ce={};const ze=[];var Pa={onLoad:function(){ze.push(tt(ce),nt(ce),rt(),lt(),ct(),dt(),gt(ce)),$.plugin?.manifest?.name!=s.storage?.inputs?.customPluginName&&($.plugin.manifest.name=s.storage?.inputs?.customPluginName)},onUnload:function(){for(const a of ze)a();$.plugin?.manifest?.name!=s.storage?.inputs?.customPluginName&&($.plugin.manifest.name=s.storage?.inputs?.customPluginName);for(const a in Ve._channelMessages)for(const r of Ve._channelMessages[a]._array)r.was_deleted&&t.FluxDispatcher.dispatch({type:"MESSAGE_DELETE",id:r.id,channelId:r.channel_id,otherPluginBypass:!0})},settings:Da};return _.default=Pa,_.regexEscaper=X,_.stripVersions=ie,_.vendettaUiAssets=Ta,Object.defineProperty(_,"__esModule",{value:!0}),_})({},vendetta,vendetta.metro,vendetta.ui.components,vendetta.patcher,vendetta.ui.assets,vendetta.utils,vendetta.metro.common,vendetta.plugin,vendetta.ui.toasts,vendetta.storage,vendetta.ui,vendetta.ui.alerts);
