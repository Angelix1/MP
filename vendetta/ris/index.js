(function(I,t,u,d,C,m,n,U,Ae,k){"use strict";d.findByProps("openLazy","hideActionSheet");function N(a,e){if(a!=null&&e!=null)for(const r of Object.keys(e))typeof e[r]=="object"&&!Array.isArray(e[r])?(typeof a[r]!="object"&&(a[r]={}),N(a[r],e[r])):a[r]??(a[r]=e[r])}function p(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,g=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return{version:a,new:e,updated:r,fix:g}}({...u.General,...u.Forms});function F(){for(var a=arguments.length,e=new Array(a),r=0;r<a;r++)e[r]=arguments[r];return[...e]}var A=[p("1.0.0",F("Created the Plugin")),p("1.0.1",F("Added FuzzySearch")),p("1.0.2",F("Added Option to remove telemetry")),p("1.0.3",F("Added Option to toggle encoding for parsed URL","Url Parser will automatically encode URL before sending to RIS APIs"))].reverse();const{ScrollView:Be,View:D,Text:Pe,TouchableOpacity:xe,TextInput:_e,Image:Te,Animated:Ce}=u.General,{FormLabel:Ue,FormIcon:K,FormArrow:ke,FormRow:L,FormSwitch:Ne,FormSwitchRow:De,FormSection:ze,FormDivider:Q,FormInput:Oe}=u.Forms,Z=m.getAssetIDByName("ic_radio_square_checked_24px"),J=m.getAssetIDByName("ic_radio_square_24px"),W=m.getAssetIDByName("ic_information_24px");m.getAssetIDByName("ic_info");const ee=m.getAssetIDByName("premium_sparkles"),te=m.getAssetIDByName("ic_sync_24px"),re=m.getAssetIDByName("ic_progress_wrench_24px"),v=t.stylesheet.createThemedStyleSheet({border:{borderRadius:10},textBody:{color:k.semanticColors.TEXT_NORMAL,fontFamily:t.constants.Fonts.PRIMARY_MEDIUM,letterSpacing:.25,fontSize:22},textBody:{color:k.semanticColors.INPUT_PLACEHOLDER_TEXT,fontFamily:t.constants.Fonts.DISPLAY_NORMAL,letterSpacing:.25,fontSize:16},versionBG:{margin:10,padding:15,backgroundColor:"rgba(55, 149, 225, 0.3)"},rowLabel:{margin:10,padding:15,backgroundColor:"rgba(33, 219, 222, 0.34)"}});function w(a){return t.React.createElement(K,{style:{opacity:1},source:a})}function ae(a){let{change:e,index:r,totalIndex:g}=a;var i,s,l;const[o,c]=t.React.useState(!1);t.React.useState(!1);function R(E,T,f,$){return t.React.createElement(D,null,t.React.createElement(L,{label:T||"No Section",subLabel:f||null,leading:$&&w($),style:[v.textHeader]}),E.map(function(b,S){return t.React.createElement(t.React.Fragment,null,t.React.createElement(L,{label:b,style:[v.textBody,v.rowLabel,v.border]}))}))}return t.React.createElement(t.React.Fragment,null,t.React.createElement(u.ErrorBoundary,null,t.React.createElement(L,{label:e?.version,leading:r==0?w(Z):w(J),trailing:w(W),onPress:function(){c(!o)}}),o&&t.React.createElement(D,{style:[v.versionBG,v.border]},(e==null||(i=e.new)===null||i===void 0?void 0:i.length)>0&&R(e.new,"New","New stuffies",ee),(e==null||(s=e.updated)===null||s===void 0?void 0:s.length)>0&&R(e.updated,"Changes","Update things",te),(e==null||(l=e.fix)===null||l===void 0?void 0:l.length)>0&&R(e.fix,"Fixes","Me hate borken things",re)),r==g.length-1?void 0:t.React.createElement(Q,null)))}const{ScrollView:ne,View:le,Text:Ge,TouchableOpacity:Ve,TextInput:je,Image:Me,Animated:He}=u.General,{FormLabel:qe,FormIcon:oe,FormArrow:Ye,FormRow:ie,FormSwitch:se,FormSwitchRow:Xe,FormSection:B,FormDivider:z,FormInput:Ke,FormRadioRow:ce}=u.Forms;function O(a,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,g=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return{id:a,label:e,subLabel:r,icon:g,def:i}}const G=[O("removeTracking","Remove Telementry","Remove additional telemetry from url or site tracking"),O("encodeURL","Encode Parsed URL","encodeURL Before sending to RIS APIs")];function ue(){return U.useProxy(n.storage),React.createElement(ne,{style:{flex:1},contentContainerStyle:{paddingBottom:38}},React.createElement(B,null,G.map(function(a,e){return React.createElement(React.Fragment,null,React.createElement(ie,{label:a?.label,subLabel:a?.subLabel,leading:a?.icon&&React.createElement(oe,{style:{opacity:1},source:m.getAssetIDByName(a?.icon)}),trailing:React.createElement(se,{value:(n.storage===null||n.storage===void 0?void 0:n.storage.toggle[a?.id])||!1,onValueChange:function(r){return n.storage.toggle[a.id]=r}})}),e==G?.length-1?void 0:React.createElement(z,null))})),React.createElement(B,{title:"Services"},React.createElement(t.ReactNative.FlatList,{data:Object.entries(n.storage.services),ItemSeparatorComponent:z,renderItem:function(a){let{item:[e,r]}=a;return React.createElement(ce,{label:r.name,selected:r.enabled,onPress:function(){return r.enabled=!r.enabled}})}})),A&&React.createElement(B,{title:"Updates"},React.createElement(le,{style:{margin:5,padding:5,borderRadius:10,backgroundColor:"rgba(0, 0, 0, 0.3)"}},A.map(function(a,e){return React.createElement(ae,{change:a,index:e,totalIndex:A.length})}))))}async function de(a){if(a){const e=`https://api-next.fuzzysearch.net/v1/url?url=${a}`;let r=await(await fetch(e,{method:"GET",headers:{"x-api-key":"eluIOaOhIP1RXlgYetkcZCF8la7p3NoCPy8U0i8dKiT4xdIH",Accept:"application/json"}})).json();return r=="unavailable"&&(r=null),r}}const{FormLabel:Qe,FormIcon:Ze,FormArrow:ge,FormRow:me,FormSwitch:Je,FormSwitchRow:We,FormSection:et,FormDivider:tt,FormInput:rt}=u.Forms,{openURL:V}=d.findByProps("openURL","openDeeplink"),fe=t.stylesheet.createThemedStyleSheet({bg:{borderRadius:10,padding:10,margin:6,backgroundColor:"rgba(87, 187, 131, 0.25)"}});function Re(a){let{data:e}=a;var r;const g={furaffinity:"https://www.furaffinity.net/view/",e621:"https://e621.net/posts/",weasyl:"https://www.weasyl.com/view/"};return t.React.createElement(t.React.Fragment,null,t.React.createElement(me,{label:e?.site,subLabel:`Uploaded/Created by ${e==null||(r=e.artists)===null||r===void 0?void 0:r[0]}`,trailing:t.React.createElement(ge,null),style:[fe.bg],onPress:function(){var i,s;if((e==null||(s=e.site)===null||s===void 0||(i=s.toLowerCase)===null||i===void 0?void 0:i.call(s))=="twitter"){var l;V(`https://twitter.com/${(l=e.artists)===null||l===void 0?void 0:l[0]}/status/${e?.site_id_str}`)}else{var o,c;V(`${g[e==null||(c=e.site)===null||c===void 0||(o=c.toLowerCase)===null||o===void 0?void 0:o.call(c)]}${e?.site_id||e?.site_id_str}`)}}}))}const{ScrollView:ve,View:he,Text:at,TouchableOpacity:nt,TextInput:lt,Image:ot,Animated:it}=u.General,{FormLabel:st,FormIcon:ct,FormArrow:ut,FormRow:j,FormSwitch:dt,FormSwitchRow:gt,FormSection:mt,FormDivider:ye,FormInput:ft}=u.Forms,M=t.stylesheet.createThemedStyleSheet({baseBg:{margin:20,padding:25,backgroundColor:"rgba(55, 149, 225, 0.3)"},bg:{borderRadius:10,backgroundColor:"rgba(117, 227, 151, 0.35)"},border:{borderRadius:10}});function be(a){let{url:e}=a;U.useProxy(n.storage);const[r,g]=t.React.useState([]);if(Array.isArray(r)&&r?.length<1){var i,s;let l=e;if(!(n.storage===null||n.storage===void 0||(i=n.storage.toggle)===null||i===void 0)&&i.removeTracking){const o=new URL(e);l=`${o.origin}${o.pathname}`}!(n.storage===null||n.storage===void 0||(s=n.storage.toggle)===null||s===void 0)&&s.encodeURL&&(l=encodeURIComponent(l)),de(l).then(function(o){return g(o)})}return t.React.createElement(t.React.Fragment,null,t.React.createElement(ve,null,t.React.createElement(he,{style:[M.baseBg,M.border]},Array.isArray(r)&&r.length<1&&t.React.createElement(t.React.Fragment,null,t.React.createElement(j,{label:"Loading..."})),Array.isArray(r)?r?.map(function(l,o){return t.React.createElement(t.React.Fragment,null,t.React.createElement(Re,{data:l}),o==r.length-1?void 0:t.React.createElement(ye,null))}):t.React.createElement(t.React.Fragment,null,t.React.createElement(j,{label:"Sorry, Couldn't find any results!"})))))}var P,x,_;const{openURL:pe}=d.findByProps("openURL","openDeeplink"),{FormRow:Fe}=u.Forms,we=d.findByName("Icon")??d.findByProps("Sizes","compare"),H=d.findByProps("openLazy","hideActionSheet"),Ee=t.React.createElement(we,{source:m.getAssetIDByName("search")}),q=d.findByProps("push","pushLazy","pop"),$e=((P=d.findByProps("getRenderCloseButton"))===null||P===void 0?void 0:P.getRenderCloseButton)??((x=d.findByProps("getHeaderCloseButton"))===null||x===void 0?void 0:x.getHeaderCloseButton),Se=d.findByName("Navigator")??((_=d.findByProps("Navigator"))===null||_===void 0?void 0:_.Navigator),h={saucenao:{name:"SauceNAO",url:"https://saucenao.com/search.php?url=%s",enabled:!0},tracemoe:{name:"trace.moe (Anime)",url:"https://trace.moe/?url=%s",enabled:!0},iqdb:{name:"IQDB",url:"https://iqdb.org/?url=%s",enabled:!1},imgops:{name:"ImgOps",url:"https://imgops.com/%s",enabled:!1},tineye:{name:"TinEye",url:"https://tineye.com/search?url=%s",enabled:!1},google:{name:"Google Images",url:"https://www.google.com/searchbyimage?image_url=%s&safe=off&sbisrc=cr_1_5_2",enabled:!1},yandex:{name:"Yandex Images",url:"https://yandex.com/images/search?rpt=imageview&url=%s",enabled:!1},fuzzysearch:{name:"FuzzySearch (FurAffinity, Twitter)",enabled:!1,titlePage:"Fuzzysearch.net"}};N(n.storage,{services:h,toggle:{removeTracking:!1,encodeURL:!1}});const Y=[];var Ie={onLoad:function(){Y.push(C.before("openLazy",H,function(a){let[e,r]=a;r==="MediaShareActionSheet"&&e.then(function(g){const i=C.after("default",g,function(s,l){let[{syncer:o}]=s;t.React.useEffect(function(){return i()},[]);let c=o.sources[o.index.value];Array.isArray(c)&&(c=c[0]);const R=c.sourceURI??c.uri,E=l.props.children.props.children;if(E){const T=Object.keys(h).filter(function(f){return n.storage.services[f].enabled});E.push(T.map(function(f){const $=function(){if(h[f].url){var b,S;let y=R;if(!(n.storage===null||n.storage===void 0||(b=n.storage.toggle)===null||b===void 0)&&b.removeTracking){const X=new URL(R);y=`${X.origin}${X.pathname}`}!(n.storage===null||n.storage===void 0||(S=n.storage.toggle)===null||S===void 0)&&S.encodeURL&&(y=encodeURIComponent(y)),pe(h[f].url.replace("%s",y))}else{const y=function(){return t.React.createElement(Se,{initialRouteName:"ServicePage",goBackOnBackPress:!0,screens:{ServicePage:{title:h[f].titlePage,headerLeft:$e?.(function(){return q.pop()}),render:function(){return t.React.createElement(be,{url:R})}}}})};H.hideActionSheet(),q.push(y)}};return t.React.createElement(t.React.Fragment,null,t.React.createElement(Fe,{leading:Ee,label:h[f].name,onPress:$}))}))}})})}))},onUnload:function(){Y.forEach(function(a){return a()})},settings:ue};return I.default=Ie,Object.defineProperty(I,"__esModule",{value:!0}),I})({},vendetta.metro.common,vendetta.ui.components,vendetta.metro,vendetta.patcher,vendetta.ui.assets,vendetta.plugin,vendetta.storage,vendetta,vendetta.ui);
