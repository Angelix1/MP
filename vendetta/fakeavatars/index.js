(function(d,m,l,E,I,h,f,Le,n,e,b,D,T,x){"use strict";l.findByProps("openLazy","hideActionSheet");function B(r,t){if(r!=null&&t!=null)for(const a of Object.keys(t))typeof t[a]=="object"&&!Array.isArray(t[a])?(typeof r[a]!="object"&&(r[a]={}),B(r[a],t[a])):r[a]??(r[a]=t[a])}function V(r,t,a,o){return{id:r,title:t,type:a,placeholder:o}}const O={...E.General,...E.Forms};l.findByProps("getUserAvatarURL","getUserAvatarSource"),l.findByStoreName("UserStore");const j=function(r){return new URL(r).pathname.split(".").slice(-1)[0]},M=Array.from(crypto.getRandomValues(new Uint8Array(20))).map(function(r){return r.toString(16).padStart(2,"0")}).join(""),L=function(r){var t,a;if((n.storage===null||n.storage===void 0||(t=n.storage.users)===null||t===void 0?void 0:t.length)<1)return;const{users:o}=n.storage;if(!((a=o[r])===null||a===void 0)&&a.avatar){var s;const i=(s=o[r])===null||s===void 0?void 0:s.avatar;return new URL(i).toString()}},w=O;var F;const{ScrollView:G,View:$e,Text:Ne,TouchableOpacity:z,TextInput:Ce,Image:X,Animated:H,FormLabel:ke,FormIcon:W,FormArrow:_e,FormRow:Y,FormSwitch:De,FormSwitchRow:xe,FormSection:K,FormDivider:S,FormInput:U,FormRadioRow:Ve}=w,Q=l.findByStoreName("GuildStore"),{ActionSheetTitleHeader:Z,ActionSheetCloseButton:q}=l.findByProps("ActionSheetTitleHeader"),{BottomSheetFlatList:J}=l.findByProps("BottomSheetScrollView"),$=l.findByProps("hideActionSheet"),ee=((F=l.findByProps("ActionSheet"))===null||F===void 0?void 0:F.ActionSheet)??find(function(r){var t;return((t=r.render)===null||t===void 0?void 0:t.name)==="ActionSheet"}),te=l.findByProps("GuildIconSizes"),re=l.findByProps("showUserProfile"),ae=[V("avatar","Override target Avatar","default","https://totally.work/image.jpg")];function ne(r){let{data:t}=r;var a;b.useProxy(n.storage),e.React.useState(!1);const[o,s]=e.React.useState([]),[i,g]=e.React.useState([]),R=!1,{username:c,avatar:Pe}=t;if(!o?.length){const u=Q.getGuilds();s(Object.values(u))}!i?.length&&(t==null||(a=t.serverAvatars)===null||a===void 0?void 0:a.length)>0&&g(t.serverAvatars);function Te(u){let{serverData:v}=u;return e.React.createElement(e.React.Fragment,null,e.React.createElement(Y,{label:v?.name||"Placeholder ServerName",subLabel:v?.id||null,disabled:i.some(function(y){return y.serverId==v?.id}),leading:e.React.createElement(te.default,{guild:v,size:"LARGE",animate:!1}),onPress:function(y){$.hideActionSheet(),D.showInputAlert({title:"Enter the link to your image link",placeholder:"can be a discord attachment CDN link",confirmText:"Confirm",confirmColor:"brand",cancelText:"Cancel",onConfirm:async function(p){var P;const _=(P=p.match(m.constants.HTTP_REGEX_MULTI))===null||P===void 0?void 0:P[0];if(!_)return f.showToast("Invalid URL",h.getAssetIDByName("Small"));f.showToast("Setting up image...",h.getAssetIDByName("ic_clock"));try{t.serverAvatars.push({serverId:v?.id,serverName:v?.name,serverPfp:_}),g(t.serverAvatars),f.showToast(`Server custom avatar Added for ${v?.name}`,h.getAssetIDByName("Check"))}catch(Be){console.error("[Fake Avatars] ImageActionSheet->serverAvatars addition error!"),m.logger.error(`ImageActionSheet->serverAvatars addition error!
${Be.stack}`),f.showToast("Failed to add server customAvatar",h.getAssetIDByName("Small"))}}})}}))}return e.React.createElement(e.React.Fragment,null,e.React.createElement(ee,{scrollable:!0},e.React.createElement(E.ErrorBoundary,null,e.React.createElement(Z,{title:"Pick target Server",leading:e.React.createElement(W,{style:{opacity:1,paddingLeft:4,paddingRight:4},source:h.getAssetIDByName("ic_category_16px"),disableColor:!0}),trailing:e.React.createElement(q,{onPress:function(){return $.hideActionSheet()}})}),e.React.createElement(J,{style:{flex:1},contentContainerStyle:{paddingBottom:36},data:o,renderItem:function(u){let{item:v}=u;return e.React.createElement(Te,{serverData:v})},ItemSeparatorComponent:S})))),e.React.createElement(e.React.Fragment,null,e.React.createElement(G,{style:{margin:5,paddingBottom:24}},e.React.createElement(E.ErrorBoundary,null,e.React.createElement(K,{title:"Default Customization"},e.React.createElement(U,{title:"User Id",value:t?.userId,disabled:!0}),e.React.createElement(S,null),e.React.createElement(U,{title:"Username",value:t?.username,disabled:!0}),e.React.createElement(S,null),ae.map(function(u,v){var y;return e.React.createElement(e.React.Fragment,null,e.React.createElement(U,{title:u?.title,keyboardType:u?.type,placeholder:u==null||(y=u.placeholder)===null||y===void 0?void 0:y.toString(),value:t[u?.id],onChange:function(p){return t[u?.id]=p.toString()}}),e.React.createElement(S,null))}),e.React.createElement(z,{onPress:function(){return re.showUserProfile({userId:t?.userId})}},e.React.createElement(H.View,{style:{alignItems:"stretch"}},e.React.createElement(X,{source:{uri:Pe||"https://cdn.discordapp.com/embed/avatars/2.png"},style:{width:128,height:128,borderRadius:10,alignSelf:"center"}})))),R)))}const ie=e.stylesheet.createThemedStyleSheet({i_like_dark:{margin:5,padding:5,borderRadius:10,backgroundColor:"rgba(0, 0, 0, 0.3)"},inputTextColor:{color:T.semanticColors.INPUT_PLACEHOLDER_TEXT},inputTextStyling:{fontSize:18,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM,color:T.semanticColors.TEXT_NORMAL}}),{ScrollView:Oe,View:le,Text:je,TouchableOpacity:se,TextInput:Me,Image:Ge,Animated:ze,FormLabel:Xe,FormIcon:He,FormArrow:We,FormRow:N,FormSwitch:Ye,FormSwitchRow:Ke,FormSection:oe,FormDivider:ce,FormInput:ue,FormRadioRow:Qe}=w,de=l.findByName("useIsFocused"),{getUser:ve}=l.findByProps("getUser");function fe(){b.useProxy(n.storage);const[r,t]=e.React.useState(""),a=e.NavigationNative.useNavigation();de();const o=function(i){a.push("VendettaCustomPage",{title:`${i?.username||"User"} Information`,render:function(){return e.React.createElement(ne,{data:i})}})},s=function(){if(r){if(!isNaN(parseInt(r)))if(!(n.storage===null||n.storage===void 0)&&n.storage.users[r])f.showToast("User already existed on the list");else{let c=ve(r);if(c){var i,g,R;n.storage.users[`${c.id}`]={userId:c.id,username:c?.username,avatar:(c==null||(R=c.getAvatarURL)===null||R===void 0||(g=R.call(c))===null||g===void 0||(i=g.replace)===null||i===void 0?void 0:i.call(g,"webp","png"))||null,serverAvatars:[]},o(n.storage.users[c.id])}else return t(""),f.showToast("Invalid User Id")}t("")}};return e.React.createElement(e.React.Fragment,null,e.React.createElement(oe,{title:"User List"},e.React.createElement(le,{style:[ie.i_like_dark]},e.React.createElement(N,{label:e.React.createElement(ue,{value:r,onChangeText:t,placeholder:"User ID",onSubmitEditing:s}),trailing:A("ic_add_24px"),onPress:s}),e.React.createElement(ce,null),Object.keys(n.storage===null||n.storage===void 0?void 0:n.storage.users).length>0&&Object.entries(n.storage===null||n.storage===void 0?void 0:n.storage.users).map(function(i,g){let[R,c]=i;return e.React.createElement(e.React.Fragment,null,e.React.createElement(N,{label:c?.username||"Couldn't find Username",subLabel:R,trailing:e.React.createElement(se,{onPress:function(){f.showToast(`${c.username} is deleted.`),delete n.storage.users[R],console.log(n.storage.users)}},A("trash")),onPress:function(){o(c)}}))}))))}const{ScrollView:ge,View:Ze,Text:qe,TouchableOpacity:Je,TextInput:et,Image:tt,Animated:rt,FormLabel:at,FormIcon:Re,FormArrow:nt,FormRow:he,FormSwitch:it,FormSwitchRow:lt,FormSection:ye,FormDivider:st,FormInput:ot,FormRadioRow:ct}=w,Ee=l.findByName("useIsFocused"),A=function(r){return React.createElement(Re,{style:{opacity:1},source:h.getAssetIDByName(r)})};function Se(){b.useProxy(n.storage);const r=e.NavigationNative.useNavigation();Ee();const t=function(){r.push("VendettaCustomPage",{title:"Users List",render:function(){return React.createElement(fe,null)}})};return React.createElement(React.Fragment,null,React.createElement(ge,null,React.createElement(E.ErrorBoundary,null,React.createElement(ye,{title:"Users List"},React.createElement(he,{label:"Click to View Users List",subLabel:"All saved users data",leading:A("ic_members"),trailing:A("ic_arrow"),onPress:t})))))}const Ae=l.findByStoreName("UserStore");function me(){return I.after("getUser",Ae,function(r,t){let[a]=r;if(d.isEnabled){var o,s;const i=n.storage===null||n.storage===void 0||(s=n.storage.users)===null||s===void 0||(o=s[a])===null||o===void 0?void 0:o.avatar;i&&(j(i)=="gif"?t.avatar=i.startsWith("a_")?avatar:`a_${avatar}`:t.avatar=i)}})}const Ie=l.findByProps("getUserAvatarURL","getUserAvatarSource");function be(){return I.after("getUserAvatarSource",Ie,function(r,t){let[{id:a},o]=r;if(d.isEnabled){const s=L(a);return s?s?{uri:s}:t:void 0}})}const we=l.findByProps("getUserAvatarURL","getUserAvatarSource");function Fe(){return I.after("getUserAvatarURL",we,function(r){let[{id:t},a]=r;if(d.isEnabled)return L(t)})}B(n.storage,{users:{}});let C=[],k;C.push(me,be,Fe);const Ue=function(){return C.forEach(function(r){return r()})};d.isEnabled=!1;var pe={onLoad:async function(){console.log(M),d.isEnabled=!0,console.log(d.isEnabled);try{k=await Ue()}catch(r){console.error("[Fake Avatars] Error when Loading"),m.logger.error(`${r.stack}`),f.showToast("Error When Loading",h.getAssetIDByName("Small")),x.stopPlugin(n.id)}},onunload:function(){d.isEnabled=!1,k?.()},settings:Se};return d.default=pe,Object.defineProperty(d,"__esModule",{value:!0}),d})({},vendetta,vendetta.metro,vendetta.ui.components,vendetta.patcher,vendetta.ui.assets,vendetta.ui.toasts,vendetta.utils,vendetta.plugin,vendetta.metro.common,vendetta.storage,vendetta.ui.alerts,vendetta.ui,vendetta.plugins);
