(function(v,m,l,E,I,h,f,Be,n,e,w,D,T,x){"use strict";l.findByProps("openLazy","hideActionSheet");function B(r,t){if(r!=null&&t!=null)for(const a of Object.keys(t))typeof t[a]=="object"&&!Array.isArray(t[a])?(typeof r[a]!="object"&&(r[a]={}),B(r[a],t[a])):r[a]??(r[a]=t[a])}function V(r,t,a,o){return{id:r,title:t,type:a,placeholder:o}}const O={...E.General,...E.Forms};l.findByProps("getUserAvatarURL","getUserAvatarSource"),l.findByStoreName("UserStore");const j=function(r){return new URL(r).pathname.split(".").slice(-1)[0]};Array.from(crypto.getRandomValues(new Uint8Array(20))).map(function(r){return r.toString(16).padStart(2,"0")}).join("");const L=function(r){var t,a;if((n.storage===null||n.storage===void 0||(t=n.storage.users)===null||t===void 0?void 0:t.length)<1)return;const{users:o}=n.storage;if(!((a=o[r])===null||a===void 0)&&a.avatar){var s;const i=(s=o[r])===null||s===void 0?void 0:s.avatar;return new URL(i).toString()}},b=O;var F;const{ScrollView:M,View:Le,Text:$e,TouchableOpacity:G,TextInput:Ne,Image:z,Animated:X,FormLabel:Ce,FormIcon:H,FormArrow:ke,FormRow:W,FormSwitch:_e,FormSwitchRow:De,FormSection:Y,FormDivider:S,FormInput:p,FormRadioRow:xe}=b,K=l.findByStoreName("GuildStore"),{ActionSheetTitleHeader:Q,ActionSheetCloseButton:Z}=l.findByProps("ActionSheetTitleHeader"),{BottomSheetFlatList:q}=l.findByProps("BottomSheetScrollView"),$=l.findByProps("hideActionSheet"),J=((F=l.findByProps("ActionSheet"))===null||F===void 0?void 0:F.ActionSheet)??find(function(r){var t;return((t=r.render)===null||t===void 0?void 0:t.name)==="ActionSheet"}),ee=l.findByProps("GuildIconSizes"),te=l.findByProps("showUserProfile"),re=[V("avatar","Override target Avatar","default","https://totally.work/image.jpg")];function ae(r){let{data:t}=r;var a;w.useProxy(n.storage),e.React.useState(!1);const[o,s]=e.React.useState([]),[i,g]=e.React.useState([]),R=!1,{username:c,avatar:Ue}=t;if(!o?.length){const u=K.getGuilds();s(Object.values(u))}!i?.length&&(t==null||(a=t.serverAvatars)===null||a===void 0?void 0:a.length)>0&&g(t.serverAvatars);function Pe(u){let{serverData:d}=u;return e.React.createElement(e.React.Fragment,null,e.React.createElement(W,{label:d?.name||"Placeholder ServerName",subLabel:d?.id||null,disabled:i.some(function(y){return y.serverId==d?.id}),leading:e.React.createElement(ee.default,{guild:d,size:"LARGE",animate:!1}),onPress:function(y){$.hideActionSheet(),D.showInputAlert({title:"Enter the link to your image link",placeholder:"can be a discord attachment CDN link",confirmText:"Confirm",confirmColor:"brand",cancelText:"Cancel",onConfirm:async function(U){var P;const _=(P=U.match(m.constants.HTTP_REGEX_MULTI))===null||P===void 0?void 0:P[0];if(!_)return f.showToast("Invalid URL",h.getAssetIDByName("Small"));f.showToast("Setting up image...",h.getAssetIDByName("ic_clock"));try{t.serverAvatars.push({serverId:d?.id,serverName:d?.name,serverPfp:_}),g(t.serverAvatars),f.showToast(`Server custom avatar Added for ${d?.name}`,h.getAssetIDByName("Check"))}catch(Te){console.error("[Fake Avatars] ImageActionSheet->serverAvatars addition error!"),m.logger.error(`ImageActionSheet->serverAvatars addition error!
${Te.stack}`),f.showToast("Failed to add server customAvatar",h.getAssetIDByName("Small"))}}})}}))}return e.React.createElement(e.React.Fragment,null,e.React.createElement(J,{scrollable:!0},e.React.createElement(E.ErrorBoundary,null,e.React.createElement(Q,{title:"Pick target Server",leading:e.React.createElement(H,{style:{opacity:1,paddingLeft:4,paddingRight:4},source:h.getAssetIDByName("ic_category_16px"),disableColor:!0}),trailing:e.React.createElement(Z,{onPress:function(){return $.hideActionSheet()}})}),e.React.createElement(q,{style:{flex:1},contentContainerStyle:{paddingBottom:36},data:o,renderItem:function(u){let{item:d}=u;return e.React.createElement(Pe,{serverData:d})},ItemSeparatorComponent:S})))),e.React.createElement(e.React.Fragment,null,e.React.createElement(M,{style:{margin:5,paddingBottom:24}},e.React.createElement(E.ErrorBoundary,null,e.React.createElement(Y,{title:"Default Customization"},e.React.createElement(p,{title:"User Id",value:t?.userId,disabled:!0}),e.React.createElement(S,null),e.React.createElement(p,{title:"Username",value:t?.username,disabled:!0}),e.React.createElement(S,null),re.map(function(u,d){var y;return e.React.createElement(e.React.Fragment,null,e.React.createElement(p,{title:u?.title,keyboardType:u?.type,placeholder:u==null||(y=u.placeholder)===null||y===void 0?void 0:y.toString(),value:t[u?.id],onChange:function(U){return t[u?.id]=U.toString()}}),e.React.createElement(S,null))}),e.React.createElement(G,{onPress:function(){return te.showUserProfile({userId:t?.userId})}},e.React.createElement(X.View,{style:{alignItems:"stretch"}},e.React.createElement(z,{source:{uri:Ue||"https://cdn.discordapp.com/embed/avatars/2.png"},style:{width:128,height:128,borderRadius:10,alignSelf:"center"}})))),R)))}const ne=e.stylesheet.createThemedStyleSheet({i_like_dark:{margin:5,padding:5,borderRadius:10,backgroundColor:"rgba(0, 0, 0, 0.3)"},inputTextColor:{color:T.semanticColors.INPUT_PLACEHOLDER_TEXT},inputTextStyling:{fontSize:18,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM,color:T.semanticColors.TEXT_NORMAL}}),{ScrollView:Ve,View:ie,Text:Oe,TouchableOpacity:le,TextInput:je,Image:Me,Animated:Ge,FormLabel:ze,FormIcon:Xe,FormArrow:He,FormRow:N,FormSwitch:We,FormSwitchRow:Ye,FormSection:se,FormDivider:oe,FormInput:ce,FormRadioRow:Ke}=b,ue=l.findByName("useIsFocused"),{getUser:de}=l.findByProps("getUser");function ve(){w.useProxy(n.storage);const[r,t]=e.React.useState(""),a=e.NavigationNative.useNavigation();ue();const o=function(i){a.push("VendettaCustomPage",{title:`${i?.username||"User"} Information`,render:function(){return e.React.createElement(ae,{data:i})}})},s=function(){if(r){if(!isNaN(parseInt(r)))if(!(n.storage===null||n.storage===void 0)&&n.storage.users[r])f.showToast("User already existed on the list");else{let c=de(r);if(c){var i,g,R;n.storage.users[`${c.id}`]={userId:c.id,username:c?.username,avatar:(c==null||(R=c.getAvatarURL)===null||R===void 0||(g=R.call(c))===null||g===void 0||(i=g.replace)===null||i===void 0?void 0:i.call(g,"webp","png"))||null,serverAvatars:[]},o(n.storage.users[c.id])}else return t(""),f.showToast("Invalid User Id")}t("")}};return e.React.createElement(e.React.Fragment,null,e.React.createElement(se,{title:"User List"},e.React.createElement(ie,{style:[ne.i_like_dark]},e.React.createElement(N,{label:e.React.createElement(ce,{value:r,onChangeText:t,placeholder:"User ID",onSubmitEditing:s}),trailing:A("ic_add_24px"),onPress:s}),e.React.createElement(oe,null),Object.keys(n.storage===null||n.storage===void 0?void 0:n.storage.users).length>0&&Object.entries(n.storage===null||n.storage===void 0?void 0:n.storage.users).map(function(i,g){let[R,c]=i;return e.React.createElement(e.React.Fragment,null,e.React.createElement(N,{label:c?.username||"Couldn't find Username",subLabel:R,trailing:e.React.createElement(le,{onPress:function(){f.showToast(`${c.username} is deleted.`),delete n.storage.users[R]}},A("trash")),onPress:function(){o(c)}}))}))))}const{ScrollView:fe,View:Qe,Text:Ze,TouchableOpacity:qe,TextInput:Je,Image:et,Animated:tt,FormLabel:rt,FormIcon:ge,FormArrow:at,FormRow:Re,FormSwitch:nt,FormSwitchRow:it,FormSection:he,FormDivider:lt,FormInput:st,FormRadioRow:ot}=b,ye=l.findByName("useIsFocused"),A=function(r){return React.createElement(ge,{style:{opacity:1},source:h.getAssetIDByName(r)})};function Ee(){w.useProxy(n.storage);const r=e.NavigationNative.useNavigation();ye();const t=function(){r.push("VendettaCustomPage",{title:"Users List",render:function(){return React.createElement(ve,null)}})};return React.createElement(React.Fragment,null,React.createElement(fe,null,React.createElement(E.ErrorBoundary,null,React.createElement(he,{title:"Users List"},React.createElement(Re,{label:"Click to View Users List",subLabel:"All saved users data",leading:A("ic_members"),trailing:A("ic_arrow"),onPress:t})))))}const Se=l.findByStoreName("UserStore");function Ae(){return I.after("getUser",Se,function(r,t){let[a]=r;if(v.isEnabled){var o,s;const i=n.storage===null||n.storage===void 0||(s=n.storage.users)===null||s===void 0||(o=s[a])===null||o===void 0?void 0:o.avatar;i&&(j(i)=="gif"?t.avatar=i.startsWith("a_")?avatar:`a_${avatar}`:t.avatar=i)}})}const me=l.findByProps("getUserAvatarURL","getUserAvatarSource");function Ie(){return I.after("getUserAvatarSource",me,function(r,t){let[{id:a},o]=r;if(v.isEnabled){const s=L(a);return s?s?{uri:s}:t:void 0}})}const we=l.findByProps("getUserAvatarURL","getUserAvatarSource");function be(){return I.after("getUserAvatarURL",we,function(r){let[{id:t},a]=r;if(v.isEnabled)return L(t)})}B(n.storage,{users:{}});let C=[],k;C.push(Ae,Ie,be);const Fe=function(){return C.forEach(function(r){return r()})};v.isEnabled=!1;var pe={onLoad:async function(){v.isEnabled=!0;try{k=await Fe()}catch(r){console.error("[Fake Avatars] Error when Loading"),m.logger.error(`${r.stack}`),f.showToast("Error When Loading",h.getAssetIDByName("Small")),x.stopPlugin(n.id)}},onunload:function(){v.isEnabled=!1,k?.()},settings:Ee};return v.default=pe,Object.defineProperty(v,"__esModule",{value:!0}),v})({},vendetta,vendetta.metro,vendetta.ui.components,vendetta.patcher,vendetta.ui.assets,vendetta.ui.toasts,vendetta.utils,vendetta.plugin,vendetta.metro.common,vendetta.storage,vendetta.ui.alerts,vendetta.ui,vendetta.plugins);
